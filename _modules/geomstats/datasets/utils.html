<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>geomstats.datasets.utils &mdash; Geomstats latest documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/sg_gallery.css" type="text/css" />
    <link rel="canonical" href="geomstats.github.io/_modules/geomstats/datasets/utils.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Geomstats
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../first-steps.html">First steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api-reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/01_data_on_manifolds.html">Tutorial: Data on Manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/02_from_vector_spaces_to_manifolds.html">Tutorial: From vector spaces to manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/03_simple_machine_learning_on_tangent_spaces.html">Tutorial: Learning on Tangent Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/04_riemannian_frechet_mean_and_tangent_pca.html">Tutorial: Fréchet Mean and Tangent PCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/05_riemannian_kmeans.html">Tutorial: K-Means clustering on a Riemannian Manifold</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/06_information_geometry.html">Tutorial: Information geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/07_implement_your_own_riemannian_geometry.html">Tutorial: Implement your own Riemannian Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/08_shape_analysis.html">Tutorial: Shape analysis of curves with the Square Root Velocity metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_cell_shapes_analysis.html">Shape Analysis of Cancer Cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_cell_shapes_analysis.html#1.-Introduction-and-Motivation">1. Introduction and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_cell_shapes_analysis.html#2.-Dataset-Description">2. Dataset Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_cell_shapes_analysis.html#3.-Preprocessing">3. Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_cell_shapes_analysis.html#4-Data-Analysis">4 Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_cell_shapes_analysis.html#Analyze-Distances-to-the-&quot;Global&quot;-Mean-Shape">Analyze Distances to the “Global” Mean Shape</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_cell_shapes_analysis.html#Hypothesis-Testing-on-Equality-of-Means">Hypothesis Testing on Equality of Means</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_cell_shapes_analysis.html#Visualization-of-the-Mean-of-each-Treatment">Visualization of the Mean of each Treatment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_cell_shapes_analysis.html#Distance-of-the-Cell-Shapes-to-their-Own-Mean-Shape">Distance of the Cell Shapes to their Own Mean Shape</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_emg_sign_classification_in_spd_manifold.html">Tutorial: Hand gesture classification with EMG data using Riemannian metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_graph_embedding_and_clustering_in_hyperbolic_space.html">Tutorial: Hyperbolic Embedding of Graphs and Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_hand_poses_analysis_in_kendall_shape_space.html">Tutorial: Classifying hands poses with Kendall shape spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_optic_nerve_heads_analysis_in_kendall_shape_space.html">Tutorial: Computing with shapes of landmarks in Kendall shape spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/usecase_visualizations_in_kendall_shape_spaces.html">Tutorial : Computing with triangular shapes in Kendall framework</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Geomstats</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>geomstats.datasets.utils</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for geomstats.datasets.utils</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Loading toy datasets.</span>

<span class="sd">Refer to notebook: `geomstats/notebooks/01_data_on_manifolds.ipynb`</span>
<span class="sd">to visualize these datasets.</span>

<span class="sd">Lead author: Nina Miolane.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">geomstats.backend</span> <span class="k">as</span> <span class="nn">gs</span>
<span class="kn">from</span> <span class="nn">geomstats.datasets.prepare_graph_data</span> <span class="kn">import</span> <span class="n">Graph</span>
<span class="kn">from</span> <span class="nn">geomstats.geometry.hypersphere</span> <span class="kn">import</span> <span class="n">Hypersphere</span>
<span class="kn">from</span> <span class="nn">geomstats.geometry.skew_symmetric_matrices</span> <span class="kn">import</span> <span class="n">SkewSymmetricMatrices</span>
<span class="kn">from</span> <span class="nn">geomstats.geometry.special_orthogonal</span> <span class="kn">import</span> <span class="n">SpecialOrthogonal</span>

<span class="n">MODULE_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">DATA_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">MODULE_PATH</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">CITIES_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;cities&quot;</span><span class="p">,</span> <span class="s2">&quot;cities.json&quot;</span><span class="p">)</span>
<span class="n">CONNECTOMES_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;connectomes/train_FNC.csv&quot;</span><span class="p">)</span>
<span class="n">CONNECTOMES_LABELS_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;connectomes/train_labels.csv&quot;</span><span class="p">)</span>

<span class="n">POSES_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;poses&quot;</span><span class="p">,</span> <span class="s2">&quot;poses.json&quot;</span><span class="p">)</span>
<span class="n">KARATE_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;graph_karate&quot;</span><span class="p">,</span> <span class="s2">&quot;karate.txt&quot;</span><span class="p">)</span>
<span class="n">KARATE_LABELS_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;graph_karate&quot;</span><span class="p">,</span> <span class="s2">&quot;karate_labels.txt&quot;</span><span class="p">)</span>
<span class="n">GRAPH_RANDOM_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;graph_random&quot;</span><span class="p">,</span> <span class="s2">&quot;graph_random.txt&quot;</span><span class="p">)</span>
<span class="n">GRAPH_RANDOM_LABELS_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;graph_random&quot;</span><span class="p">,</span> <span class="s2">&quot;graph_random_labels.txt&quot;</span>
<span class="p">)</span>
<span class="n">LEAVES_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;leaves&quot;</span><span class="p">,</span> <span class="s2">&quot;leaves.csv&quot;</span><span class="p">)</span>
<span class="n">EMG_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;emg&quot;</span><span class="p">,</span> <span class="s2">&quot;emg.csv&quot;</span><span class="p">)</span>
<span class="n">OPTICAL_NERVES_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;optical_nerves&quot;</span><span class="p">,</span> <span class="s2">&quot;optical_nerves.txt&quot;</span><span class="p">)</span>
<span class="n">HANDS_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;hands&quot;</span><span class="p">,</span> <span class="s2">&quot;hands.txt&quot;</span><span class="p">)</span>
<span class="n">HANDS_LABELS_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;hands&quot;</span><span class="p">,</span> <span class="s2">&quot;labels.txt&quot;</span><span class="p">)</span>
<span class="n">CELLS_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;cells&quot;</span><span class="p">,</span> <span class="s2">&quot;cells.txt&quot;</span><span class="p">)</span>
<span class="n">CELL_LINES_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;cells&quot;</span><span class="p">,</span> <span class="s2">&quot;cell_lines.txt&quot;</span><span class="p">)</span>
<span class="n">CELL_TREATMENTS_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s2">&quot;cells&quot;</span><span class="p">,</span> <span class="s2">&quot;treatments.txt&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="load_cities"><a class="viewcode-back" href="../../../datasets.html#geomstats.datasets.utils.load_cities">[docs]</a><span class="k">def</span> <span class="nf">load_cities</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Load data from data/cities/cities.json.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data : array-like, shape=[50, 2]</span>
<span class="sd">        Array with each row representing one sample,</span>
<span class="sd">        i. e. latitude and longitude of a city.</span>
<span class="sd">        Angles are in radians.</span>
<span class="sd">    name : list</span>
<span class="sd">        List of city names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CITIES_PATH</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">data_file</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>

        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;city&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_file</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="nb">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">[</span>
                    <span class="n">row</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">gs</span><span class="o">.</span><span class="n">pi</span> <span class="k">for</span> <span class="n">col_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lng&quot;</span><span class="p">]</span>
                <span class="p">],</span>
                <span class="n">data_file</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">colat</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">colat</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">colat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">lng</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">gs</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">colat</span><span class="p">,</span> <span class="n">lng</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sphere</span> <span class="o">=</span> <span class="n">Hypersphere</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">sphere</span><span class="o">.</span><span class="n">spherical_to_extrinsic</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">names</span></div>


<div class="viewcode-block" id="load_random_graph"><a class="viewcode-back" href="../../../datasets.html#geomstats.datasets.utils.load_random_graph">[docs]</a><span class="k">def</span> <span class="nf">load_random_graph</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Load data from data/graph_random.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    graph: prepare_graph_data.Graph</span>
<span class="sd">        Graph containing nodes, edges, and labels from the random dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Graph</span><span class="p">(</span><span class="n">GRAPH_RANDOM_PATH</span><span class="p">,</span> <span class="n">GRAPH_RANDOM_LABELS_PATH</span><span class="p">)</span></div>


<div class="viewcode-block" id="load_karate_graph"><a class="viewcode-back" href="../../../datasets.html#geomstats.datasets.utils.load_karate_graph">[docs]</a><span class="k">def</span> <span class="nf">load_karate_graph</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Load data from data/graph_karate.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    graph: prepare_graph_data.Graph</span>
<span class="sd">        Graph containing nodes, edges, and labels from the karate dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Graph</span><span class="p">(</span><span class="n">KARATE_PATH</span><span class="p">,</span> <span class="n">KARATE_LABELS_PATH</span><span class="p">)</span></div>


<div class="viewcode-block" id="load_poses"><a class="viewcode-back" href="../../../datasets.html#geomstats.datasets.utils.load_poses">[docs]</a><span class="k">def</span> <span class="nf">load_poses</span><span class="p">(</span><span class="n">only_rotations</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load data from data/poses/poses.csv.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data : array-like, shape=[5, 3] or shape=[5, 6]</span>
<span class="sd">        Array with each row representing one sample,</span>
<span class="sd">        i. e. one 3D rotation or one 3D rotation + 3D translation.</span>
<span class="sd">    img_paths : list</span>
<span class="sd">        List of img paths.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">img_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">so3</span> <span class="o">=</span> <span class="n">SpecialOrthogonal</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">point_type</span><span class="o">=</span><span class="s2">&quot;vector&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">POSES_PATH</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
        <span class="n">data_file</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_file</span><span class="p">:</span>
            <span class="n">pose_mat</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;rot_mat&quot;</span><span class="p">])</span>
            <span class="n">pose_vec</span> <span class="o">=</span> <span class="n">so3</span><span class="o">.</span><span class="n">rotation_vector_from_matrix</span><span class="p">(</span><span class="n">pose_mat</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">only_rotations</span><span class="p">:</span>
                <span class="n">trans_vec</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;trans_mat&quot;</span><span class="p">])</span>
                <span class="n">pose_vec</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">pose_vec</span><span class="p">,</span> <span class="n">trans_vec</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pose_vec</span><span class="p">)</span>
            <span class="n">img_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;img&quot;</span><span class="p">])</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">img_paths</span></div>


<div class="viewcode-block" id="load_connectomes"><a class="viewcode-back" href="../../../datasets.html#geomstats.datasets.utils.load_connectomes">[docs]</a><span class="k">def</span> <span class="nf">load_connectomes</span><span class="p">(</span><span class="n">as_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load data from brain connectomes.</span>

<span class="sd">    Load the correlation data from the kaggle MSLP 2014 Schizophrenia</span>
<span class="sd">    Challenge. The original data came as flattened vectors, but if `raw=True`</span>
<span class="sd">    is passed, the correlation values are reshaped as symmetric matrices with</span>
<span class="sd">    ones on the diagonal.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    as_vectors : bool</span>
<span class="sd">        Whether to return raw data as vectors or as symmetric matrices.</span>
<span class="sd">        Optional, default: False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mat : array-like, shape=[86, {[28, 28], 378}</span>
<span class="sd">        Connectomes.</span>
<span class="sd">    patient_id : array-like, shape=[86,]</span>
<span class="sd">        Patient unique identifiers</span>
<span class="sd">    target : array-like, shape=[86,]</span>
<span class="sd">        Labels, whether patients belong to the diseased class (1) or control</span>
<span class="sd">        (0).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CONNECTOMES_PATH</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
        <span class="n">data_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">))</span>
    <span class="n">patient_id</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CONNECTOMES_LABELS_PATH</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">))</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
    <span class="k">if</span> <span class="n">as_vectors</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">target</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">SkewSymmetricMatrices</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span><span class="o">.</span><span class="n">matrix_representation</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="o">-</span> <span class="n">gs</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">mat</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">mat</span> <span class="o">+</span> <span class="n">gs</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="k">return</span> <span class="n">mat</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">target</span></div>


<div class="viewcode-block" id="load_leaves"><a class="viewcode-back" href="../../../datasets.html#geomstats.datasets.utils.load_leaves">[docs]</a><span class="k">def</span> <span class="nf">load_leaves</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Load data from data/leaves/leaves.xlsx.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    beta_param : array-like, shape=[172, 2]</span>
<span class="sd">        Beta parameters of the beta distributions fitted to each</span>
<span class="sd">        leaf orientation angle sample of 172 species of plants.</span>
<span class="sd">    distrib_type: array-like, shape=[172, ]</span>
<span class="sd">        Leaf orientation angle distribution type for each of the 172 species.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">LEAVES_PATH</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
    <span class="n">beta_param</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;nu&quot;</span><span class="p">,</span> <span class="s2">&quot;mu&quot;</span><span class="p">]])</span>
    <span class="n">distrib_type</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Distribution&quot;</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">beta_param</span><span class="p">,</span> <span class="n">distrib_type</span></div>


<div class="viewcode-block" id="load_emg"><a class="viewcode-back" href="../../../datasets.html#geomstats.datasets.utils.load_emg">[docs]</a><span class="k">def</span> <span class="nf">load_emg</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Load data from data/emg/emg.csv.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data_emg : pandas.DataFrame, shape=[731682, 10]</span>
<span class="sd">        Emg time serie for each of the 8 electrodes, with the time stamps</span>
<span class="sd">        and the label of the hand sign.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_emg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">EMG_PATH</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_emg</span></div>


<div class="viewcode-block" id="load_optical_nerves"><a class="viewcode-back" href="../../../datasets.html#geomstats.datasets.utils.load_optical_nerves">[docs]</a><span class="k">def</span> <span class="nf">load_optical_nerves</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Load data from data/optical_nerves/optical_nerves.txt.</span>

<span class="sd">    Load the dataset of sets of 5 landmarks, labelled S, T, I, N, V, in 3D</span>
<span class="sd">    on monkeys&#39; optical nerve heads:</span>
<span class="sd">    - 1st landmark (S): superior aspect of the retina,</span>
<span class="sd">    - 2nd landmark (T): side of the retina closest to the temporal</span>
<span class="sd">        bone of the skull,</span>
<span class="sd">    - 3rd landmark (N): nose side of the retina,</span>
<span class="sd">    - 4th landmark (I): inferior point,</span>
<span class="sd">    - 5th landmarks (V): optical nerve head deepest point.</span>

<span class="sd">    For each monkey, an experimental glaucoma was introduced in one eye,</span>
<span class="sd">    while the second eye was kept as control. This dataset can be used to</span>
<span class="sd">    investigate a significant difference between the glaucoma and the</span>
<span class="sd">    control eyes.</span>

<span class="sd">    Label 0 refers to a normal eye, and Label 1 to an eye with glaucoma.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">        .. [PE2015] V. Patrangenaru and L. Ellingson. Nonparametric Statistics</span>
<span class="sd">          on Manifolds and Their Applications to Object Data, 2015.</span>
<span class="sd">          https://doi.org/10.1201/b18969</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data : array-like, shape=[22, 5, 3]</span>
<span class="sd">        Data representing the 5 landmarks, in 3D, for 11 different monkeys.</span>
<span class="sd">    labels : array-like, shape=[22,]</span>
<span class="sd">        Labels in {0, 1} classifying the corresponding optical nerve as</span>
<span class="sd">        normal (label = 0) or glaucoma (label = 1).</span>
<span class="sd">    monkeys : array-like, shape=[22,]</span>
<span class="sd">        Indices in 0...10 referencing the index of the monkey to which a given</span>
<span class="sd">        optical nerve belongs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nerves</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">OPTICAL_NERVES_PATH</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">nerves</span> <span class="o">=</span> <span class="n">nerves</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Filename&quot;</span><span class="p">)</span>
    <span class="n">nerves</span> <span class="o">=</span> <span class="n">nerves</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;laljn103.12b&quot;</span><span class="p">,</span> <span class="s2">&quot;lalj0103.12b&quot;</span><span class="p">])</span>
    <span class="n">nerves</span> <span class="o">=</span> <span class="n">nerves</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">nerves_gs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nerves</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nerves_gs</span><span class="p">,</span> <span class="p">(</span><span class="n">nerves_gs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">nerves_gs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">monkeys</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">monkeys</span></div>


<div class="viewcode-block" id="load_hands"><a class="viewcode-back" href="../../../datasets.html#geomstats.datasets.utils.load_hands">[docs]</a><span class="k">def</span> <span class="nf">load_hands</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Load data from data/hands/hands.txt and labels.txt.</span>

<span class="sd">    Load the dataset of hand poses, where a hand is represented as a</span>
<span class="sd">    set of 22 landmarks - the hands joints - in 3D.</span>

<span class="sd">    The hand poses represent two different hand poses:</span>
<span class="sd">    - Label 0: hand is in the position &quot;Grab&quot;</span>
<span class="sd">    - Label 1: hand is in the position &quot;Expand&quot;</span>

<span class="sd">    This is a subset of the SHREC 2017 dataset [SWVGLF2017].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">        .. [SWVGLF2017] Q. De Smedt, H. Wannous, J.P. Vandeborre,</span>
<span class="sd">        J. Guerry, B. Le Saux, D. Filliat, SHREC&#39;17 Track: 3D Hand Gesture</span>
<span class="sd">        Recognition Using a Depth and Skeletal Dataset, 10th Eurographics</span>
<span class="sd">        Workshop on 3D Object Retrieval, 2017.</span>
<span class="sd">        https://doi.org/10.2312/3dor.20171049</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data : array-like, shape=[52, 22, 3]</span>
<span class="sd">        Hand data, represented as a list of 22 joints, specifically as</span>
<span class="sd">        the 3D coordinates of these joints.</span>
<span class="sd">    labels : array-like, shape=[52,]</span>
<span class="sd">        Label representing hands poses. Label 0: &quot;Grab&quot;, Label 1: &quot;Expand&quot;</span>
<span class="sd">    bone_list : array-like</span>
<span class="sd">        List of bones, as a list of connexions between joints.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">HANDS_PATH</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">n_landmarks</span> <span class="o">=</span> <span class="mi">22</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_landmarks</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">HANDS_LABELS_PATH</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>

    <span class="n">bone_list</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">bone_list</span></div>


<div class="viewcode-block" id="load_cells"><a class="viewcode-back" href="../../../datasets.html#geomstats.datasets.utils.load_cells">[docs]</a><span class="k">def</span> <span class="nf">load_cells</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Load cell data.</span>

<span class="sd">    This cell dataset contains cell boundaries of mouse osteosarcoma</span>
<span class="sd">    (bone cancer) cells. The dlm8 cell line is derived from dunn and is more</span>
<span class="sd">    aggressive as a cancer. The cells have been treated with one of three</span>
<span class="sd">    treatments : control (no treatment), jasp (jasplakinolide)</span>
<span class="sd">    and cytd (cytochalasin D). These are drugs which perturb the cytoskelet</span>
<span class="sd">    of the cells.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cells : list of 650 planar discrete curves</span>
<span class="sd">        Each curve represents the boundary of a cell in counterclockwise order,</span>
<span class="sd">        their lengths are not necessarily equal.</span>
<span class="sd">    cell_lines : list of 650 strings</span>
<span class="sd">        List of the cell lines of each cell (dlm8 or dunn).</span>
<span class="sd">    treatments : list of 650 strings</span>
<span class="sd">        List of the treatments given to each cell (control, cytd or jasp).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CELLS_PATH</span><span class="p">)</span> <span class="k">as</span> <span class="n">cells_file</span><span class="p">:</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="n">cells_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cells</span><span class="p">):</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">curve</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">cell</span><span class="p">:</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">point</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
            <span class="n">curve</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">curve</span><span class="p">),</span> <span class="n">gs</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CELL_LINES_PATH</span><span class="p">)</span> <span class="k">as</span> <span class="n">cell_lines_file</span><span class="p">:</span>
        <span class="n">cell_lines</span> <span class="o">=</span> <span class="n">cell_lines_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CELL_TREATMENTS_PATH</span><span class="p">)</span> <span class="k">as</span> <span class="n">treatments_file</span><span class="p">:</span>
        <span class="n">treatments</span> <span class="o">=</span> <span class="n">treatments_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cells</span><span class="p">,</span> <span class="n">cell_lines</span><span class="p">,</span> <span class="n">treatments</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Geomstats, Inc..
      <span class="lastupdated">Last updated on Feb 4, 2022, 11:47:59 PM.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>