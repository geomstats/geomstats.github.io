

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial: Data on Manifolds &mdash; Geomstats latest documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial: From vector spaces to manifolds" href="02_from_vector_spaces_to_manifolds.html" />
    <link rel="prev" title="Contributing" href="contributing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Geomstats
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="first-steps.html">First steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial: Data on Manifolds</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#from-data-on-linear-spaces-to-data-on-manifolds">From data on linear spaces to data on manifolds</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples-of-data-on-manifolds">Examples of data on manifolds</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#world-cities-data-on-the-sphere">World cities: data on the sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pose-of-objects-in-pictures">Pose of objects in pictures</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="02_from_vector_spaces_to_manifolds.html">Tutorial: From vector spaces to manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_simple_machine_learning_tangent_spaces.html">Tutorial: Learning on Tangent Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_frechet_mean_and_tangent_pca.html">Tutorial: Fréchet Mean and Tangent PCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_embedding_graph_structured_data_h2.html">Tutorial: Hyperbolic Embedding of Graphs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Geomstats</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Tutorial: Data on Manifolds</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/01_data_on_manifolds.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="tutorial-data-on-manifolds">
<h1>Tutorial: Data on Manifolds<a class="headerlink" href="#tutorial-data-on-manifolds" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>Before starting this tutorial, we set the working directory to be the
root of the geomstats repository. In order to have the code working on
your machine, you need to change this path to the path of your geomstats
repository.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">geomstats_gitroot_path</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;git&#39;</span><span class="p">,</span> <span class="s1">&#39;rev-parse&#39;</span><span class="p">,</span> <span class="s1">&#39;--show-toplevel&#39;</span><span class="p">],</span>
    <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">geomstats_gitroot_path</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Working directory: &#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Working</span> <span class="n">directory</span><span class="p">:</span>  <span class="o">/</span><span class="n">code</span><span class="o">/</span><span class="n">geomstats</span>
</pre></div>
</div>
<p>We import the backend that will be used for geomstats computations and
set a seed for reproducibility of the results.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geomstats.backend</span> <span class="k">as</span> <span class="nn">gs</span>

<span class="n">gs</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INFO</span><span class="p">:</span> <span class="n">Using</span> <span class="n">numpy</span> <span class="n">backend</span>
</pre></div>
</div>
<p>Finally, we import the visualization module.import the visualization
module.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="k">as</span> <span class="nn">mpimg</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">geomstats.visualization</span> <span class="k">as</span> <span class="nn">visualization</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">tutorial_matplotlib</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="from-data-on-linear-spaces-to-data-on-manifolds">
<h2>From data on linear spaces to data on manifolds<a class="headerlink" href="#from-data-on-linear-spaces-to-data-on-manifolds" title="Permalink to this headline">¶</a></h2>
<p>The <strong>science of Statistics</strong> is defined as the collection of data,
their analysis and interpretation. Statistical theory is usually defined
for data belonging to vector spaces, which are <em>linear spaces</em>. For
example, we know how to compute the mean of a data set of numbers, like
the mean of students’ weights in a classroom, or of multidimensional
arrays, like the average 3D velocity vector of blood cells in a vessel.</p>
<p>Here is an example of the computation of the mean of two arrays of
dimension 2.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geomstats.geometry.euclidean</span> <span class="kn">import</span> <span class="n">Euclidean</span>

<span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">euclidean</span> <span class="o">=</span> <span class="n">Euclidean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>
<span class="n">points_in_linear_space</span> <span class="o">=</span> <span class="n">euclidean</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Points in linear space:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">points_in_linear_space</span><span class="p">)</span>

<span class="n">linear_mean</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">points_in_linear_space</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_samples</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean of points:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">linear_mean</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Points</span> <span class="ow">in</span> <span class="n">linear</span> <span class="n">space</span><span class="p">:</span>
 <span class="p">[[</span> <span class="mf">0.97255366</span>  <span class="mf">0.74678389</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">0.01949105</span> <span class="o">-</span><span class="mf">0.45632857</span><span class="p">]]</span>
<span class="n">Mean</span> <span class="n">of</span> <span class="n">points</span><span class="p">:</span>
 <span class="p">[</span><span class="mf">0.49602235</span> <span class="mf">0.14522766</span><span class="p">]</span>
</pre></div>
</div>
<p>We plot the points and their mean on the 2D Euclidean space, which is a
linear space: a plane.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">points_in_linear_space</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points_in_linear_space</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Points&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points_in_linear_space</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points_in_linear_space</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">linear_mean</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <span class="n">gs</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">linear_mean</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean of points in a linear space&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/01_data_on_manifolds_12_0.png" src="_images/01_data_on_manifolds_12_0.png" />
<p>What happens to the usual statistical theory when the data doesn’t
naturally belong to a linear space. For example, if we want to perform
statistics on the coordinates of world cities, which lie on the earth: a
sphere?</p>
<p>The non-linear spaces we consider are called manifolds. A <strong>manifold
:math:`M` of dimension :math:`m`</strong> is a space that is allowed to be
curved but that looks like an <span class="math notranslate nohighlight">\(m\)</span>-dimensional vector space in the
neighborhood of every point.</p>
<p>A sphere, like the earth, is a good example of a manifold. We know that
the earth is curved, but at our scale we do not see its curvature. Can
we still use linear statistics when data are defined on these manifolds,
or shall we?</p>
<p>Let’s try.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geomstats.geometry.hypersphere</span> <span class="kn">import</span> <span class="n">Hypersphere</span>

<span class="n">sphere</span> <span class="o">=</span> <span class="n">Hypersphere</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>
<span class="n">points_in_manifold</span> <span class="o">=</span> <span class="n">sphere</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Points in manifold:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">points_in_manifold</span><span class="p">)</span>

<span class="n">linear_mean</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">points_in_manifold</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_samples</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean of points:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">linear_mean</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Points</span> <span class="ow">in</span> <span class="n">manifold</span><span class="p">:</span>
 <span class="p">[[</span><span class="o">-</span><span class="mf">0.71502435</span> <span class="o">-</span><span class="mf">0.41197257</span> <span class="o">-</span><span class="mf">0.56481748</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.997575</span>   <span class="o">-</span><span class="mf">0.04788171</span>  <span class="mf">0.05051201</span><span class="p">]]</span>
<span class="n">Mean</span> <span class="n">of</span> <span class="n">points</span><span class="p">:</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.85629967</span> <span class="o">-</span><span class="mf">0.22992714</span> <span class="o">-</span><span class="mf">0.25715273</span><span class="p">]</span>
</pre></div>
</div>
<p>We plot the points and their mean computed with the linear formula.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">points_in_manifold</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Point&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">points_in_manifold</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">points_in_manifold</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">points_in_manifold</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">linear_mean</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linear_mean</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linear_mean</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean of points on a manifold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/01_data_on_manifolds_16_0.png" src="_images/01_data_on_manifolds_16_0.png" />
<p>What happened? The mean of two points on a manifold (the sphere) is not
on the manifold. In our example, the mean city is not on the earth. This
leads to errors in statistical computations.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">belongs</span><span class="p">(</span><span class="n">linear_mean</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span>
</pre></div>
</div>
<p>For this reason, researchers aim to build a theory of statistics that is
by construction compatible with any structure we equip the manifold
with. This theory is called <em>Geometric Statistics</em>.</p>
<p><strong>Geometric Statistics</strong> is a theory of statistics on manifolds, that
takes into account their geometric structures. Geometric Statistics is
therefore the child of two major pillars of Mathematics: Geometry and
Statistics.</p>
</div>
<div class="section" id="examples-of-data-on-manifolds">
<h2>Examples of data on manifolds<a class="headerlink" href="#examples-of-data-on-manifolds" title="Permalink to this headline">¶</a></h2>
<p>Why should we bother to build a whole new theory of statistics? Do we
really have data that belong to spaces like the sphere illustrated in
introduction?</p>
<p>Let’s see some examples of data spaces that are naturally manifolds. By
doing so, we will introduce the <code class="docutils literal notranslate"><span class="pre">datasets</span></code> and <code class="docutils literal notranslate"><span class="pre">visualization</span></code>
modules of <code class="docutils literal notranslate"><span class="pre">geomstats</span></code>.</p>
<p>We first import the <code class="docutils literal notranslate"><span class="pre">datasets.utils</span></code> module that allows loading
datasets.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geomstats.datasets.utils</span> <span class="k">as</span> <span class="nn">data_utils</span>
</pre></div>
</div>
<div class="section" id="world-cities-data-on-the-sphere">
<h3>World cities: data on the sphere<a class="headerlink" href="#world-cities-data-on-the-sphere" title="Permalink to this headline">¶</a></h3>
<p>We load the dataset <code class="docutils literal notranslate"><span class="pre">cities</span></code>, that contains the coordinates of world
cities in spherical coordinates.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="n">data_utils</span><span class="o">.</span><span class="n">load_cities</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">names</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;Tokyo&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Mexico City&#39;</span><span class="p">,</span> <span class="s1">&#39;Mumbai&#39;</span><span class="p">,</span> <span class="s1">&#39;São Paulo&#39;</span><span class="p">]</span>
<span class="p">[[</span> <span class="mf">0.61993792</span> <span class="o">-</span><span class="mf">0.52479018</span>  <span class="mf">0.58332859</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.20994315</span>  <span class="mf">0.7285533</span>   <span class="mf">0.65202298</span><span class="p">]</span>
 <span class="p">[</span> <span class="mf">0.14964311</span>  <span class="mf">0.93102728</span>  <span class="mf">0.33285904</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.27867026</span> <span class="o">-</span><span class="mf">0.9034188</span>   <span class="mf">0.32584868</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.62952884</span>  <span class="mf">0.6662902</span>  <span class="o">-</span><span class="mf">0.3996884</span> <span class="p">]]</span>
</pre></div>
</div>
<p>We convert the spherical coordinates to X, Y, Z coordinates and verify
that they belong to the sphere.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">belongs</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<p>Now, we plot the cities on the sphere. We choose only a subset of the
cities that have a nice rendering in the 2D plot of the 3D earth. This
plot is nicer shown in an interactive 3D figure.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="n">data_utils</span><span class="o">.</span><span class="n">load_cities</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">15</span><span class="p">:</span><span class="mi">20</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">names</span><span class="p">[</span><span class="mi">15</span><span class="p">:</span><span class="mi">20</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cities on the earth.&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/01_data_on_manifolds_30_0.png" src="_images/01_data_on_manifolds_30_0.png" />
</div>
<div class="section" id="pose-of-objects-in-pictures">
<h3>Pose of objects in pictures<a class="headerlink" href="#pose-of-objects-in-pictures" title="Permalink to this headline">¶</a></h3>
<p>We consider the dataset <code class="docutils literal notranslate"><span class="pre">poses</span></code>, that contains the 3D poses of objects
in images. Specifically, we consider poses of beds in images, i.e. the
3D orientation of each bed within a given 2D image.</p>
<p>The orientation corresponds to a 3D rotation. A 3D rotation <span class="math notranslate nohighlight">\(R\)</span> is
visually represented as the result of <span class="math notranslate nohighlight">\(R\)</span> applied to the
coordinate frame <span class="math notranslate nohighlight">\((e_x, e_y, e_z)\)</span>.</p>
<p>We first load the dataset.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">,</span> <span class="n">img_paths</span> <span class="o">=</span> <span class="n">data_utils</span><span class="o">.</span><span class="n">load_poses</span><span class="p">()</span>

<span class="n">img_path1</span><span class="p">,</span> <span class="n">img_path2</span> <span class="o">=</span> <span class="n">img_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">img_paths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">img_path1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_utils</span><span class="o">.</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;poses&#39;</span><span class="p">,</span> <span class="n">img_path1</span><span class="p">)</span>
<span class="n">img_path2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_utils</span><span class="o">.</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;poses&#39;</span><span class="p">,</span> <span class="n">img_path2</span><span class="p">)</span>

<span class="n">img1</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_path1</span><span class="p">)</span>
<span class="n">img2</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_path2</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">imgplot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">imgplot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/01_data_on_manifolds_33_0.png" src="_images/01_data_on_manifolds_33_0.png" />
<p>We import the manifold of 3D rotations: the Special Orthogonal group in
3D, <span class="math notranslate nohighlight">\(SO(3)\)</span>. We choose to represent the 3D rotations as rotation
vectors, hence: <code class="docutils literal notranslate"><span class="pre">point_type='vector'</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geomstats.geometry.special_orthogonal</span> <span class="kn">import</span> <span class="n">SpecialOrthogonal</span>

<span class="n">so3</span> <span class="o">=</span> <span class="n">SpecialOrthogonal</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">point_type</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We verify that the poses belong to the space of 3D rotations.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">so3</span><span class="o">.</span><span class="n">belongs</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<p>We plot the orientations of the first 2 beds.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="s1">&#39;SO3_GROUP&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;3D orientations of the beds.&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/01_data_on_manifolds_39_0.png" src="_images/01_data_on_manifolds_39_0.png" />
<p>These orientations are very close, as expected from the corresponding
images.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="02_from_vector_spaces_to_manifolds.html" class="btn btn-neutral float-right" title="Tutorial: From vector spaces to manifolds" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="contributing.html" class="btn btn-neutral float-left" title="Contributing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019-2020, Geomstats, Inc.
      <span class="lastupdated">
        Last updated on Dec 18, 2020, 6:22:36 PM.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>