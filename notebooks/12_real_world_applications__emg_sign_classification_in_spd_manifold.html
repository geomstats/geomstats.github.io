
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hand gesture classification with EMG data using Riemannian metrics &#8212; Geomstats latest documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=c6e86fd7"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/12_real_world_applications__emg_sign_classification_in_spd_manifold';</script>
    <link rel="canonical" href="geomstats.github.io/notebooks/12_real_world_applications__emg_sign_classification_in_spd_manifold.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hyperbolic Embedding of Graphs and Clustering" href="13_real_world_applications__graph_embedding_and_clustering_in_hyperbolic_space.html" />
    <link rel="prev" title="Shape Analysis of Cancer Cells" href="11_real_world_applications__cell_shapes_analysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Mar 8, 2024, 1:45:13 PM"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Geomstats latest documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation/index.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../tutorials/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API Reference
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../roadmap.html">
                        Roadmap
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../governance.html">
                        Governance
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../gsod.html">
                        Google Season of Docs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../hackathons.html">
                        Hackathons
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation/index.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../tutorials/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API Reference
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../roadmap.html">
                        Roadmap
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../governance.html">
                        Governance
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../gsod.html">
                        Google Season of Docs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../hackathons.html">
                        Hackathons
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="03_practical_methods__data_on_manifolds.html">Data on Manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_practical_methods__from_vector_spaces_to_manifolds.html">From vector spaces to manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_practical_methods__simple_machine_learning_on_tangent_spaces.html">Learning on Tangent Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_practical_methods__riemannian_frechet_mean_and_tangent_pca.html">Fréchet Mean and Tangent PCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_practical_methods__riemannian_kmeans.html">K-Means clustering on a Riemannian Manifold</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_practical_methods__information_geometry.html">Information geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_practical_methods__implement_your_own_riemannian_geometry.html">Implement your own Riemannian Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_practical_methods__shape_analysis.html">Shape analysis of curves with the Square Root Velocity metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="19_practical_methods__aac.html">Align all and Compute for Graphs</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="11_real_world_applications__cell_shapes_analysis.html">Shape Analysis of Cancer Cells</a></li>









<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hand gesture classification with EMG data using Riemannian metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_real_world_applications__graph_embedding_and_clustering_in_hyperbolic_space.html">Hyperbolic Embedding of Graphs and Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_real_world_applications__hand_poses_analysis_in_kendall_shape_space.html">Classifying hands poses with Kendall shape spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_real_world_applications__optic_nerve_heads_analysis_in_kendall_shape_space.html">Computing with shapes of landmarks in Kendall shape spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_real_world_applications__visualizations_in_kendall_shape_spaces.html">Computing with triangular shapes in Kendall framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_real_world_applications__sao_paulo_traffic_optimization.html">Optimization of Sao Paulo traffic</a></li>






<li class="toctree-l1"><a class="reference internal" href="20_real_world_applications__graph_space.html">Graph Space</a></li>


</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../tutorials/index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Hand...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="admonition note">
  <p>Notebook source code:
    <a class="reference external" href="https://github.com/geomstats/geomstats/blob/main/notebooks/12_real_world_applications__emg_sign_classification_in_spd_manifold.ipynb">notebooks/12_real_world_applications__emg_sign_classification_in_spd_manifold.ipynb</a>
    <br>Run it yourself on binder
    <a href="https://mybinder.org/v2/gh/geomstats/geomstats/main?filepath=notebooks/12_real_world_applications__emg_sign_classification_in_spd_manifold.ipynb"><img alt="Binder badge"
    src="https://mybinder.org/badge_logo.svg"
    style="vertical-align:text-bottom"></a>
  </p>
</div><section id="Hand-gesture-classification-with-EMG-data-using-Riemannian-metrics">
<h1>Hand gesture classification with EMG data using Riemannian metrics<a class="headerlink" href="#Hand-gesture-classification-with-EMG-data-using-Riemannian-metrics" title="Link to this heading">#</a></h1>
<p>Lead author: Marius Guerard.</p>
<p>In this notebook we are using EMG time series collected by 8 electrodes placed on the arm skin. We are going to show how to:</p>
<ul class="simple">
<li><p>Process these kind of signal into covariance matrices that we can manipulate with geomstats tools.</p></li>
<li><p>How to apply ML algorithms on this data to classify four different hand gestures present in the data (Rock, Paper, Scissors, Ok).</p></li>
<li><p>How do the different methods (using Riemanian metrics, projecting on tangent space, Euclidean metric) compare to each other.</p></li>
</ul>
<p><img alt="17d705263fe84e93bbf23eaa53fb6961" src="../_images/paper_rock_scissors.png" /></p>
<section id="Context">
<h2>Context<a class="headerlink" href="#Context" title="Link to this heading">#</a></h2>
<p>The data are acquired from somOS-interface: an sEMG armband that allows you to interact via bluetooth with an Android smartphone (you can contact Marius Guerard (<a class="reference external" href="mailto:marius&#46;guerard&#37;&#52;&#48;gmail&#46;com">marius<span>&#46;</span>guerard<span>&#64;</span>gmail<span>&#46;</span>com</a>) or Renaud Renault (<a class="reference external" href="mailto:renaud&#46;armand&#46;renault&#37;&#52;&#48;gmail&#46;com">renaud<span>&#46;</span>armand<span>&#46;</span>renault<span>&#64;</span>gmail<span>&#46;</span>com</a>) for more info on how to make this kind of armband yourself).</p>
<p>An example of application is to record static signs that are linked with different actions (moving a cursor and clicking, sign recognition for command based personal assistants, …). In these experiments, we want to evaluate the difference in performance (measured as the accuracy of sign recognition) between three different real life situations where we change the conditions of training (when user record signs or “calibrate” the device) and testing (when the app guess what sign the user is
doing):</p>
<ul class="simple">
<li><ol class="arabic simple">
<li><p>What is the accuracy when doing sign recognition right after training?</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="2">
<li><p>What is the accuracy when calibrating, removing and replacing the armband at the same position and then testing?</p></li>
</ol>
</li>
<li><ol class="arabic simple" start="3">
<li><p>What is the accuracy when calibrating, removing the armband and giving it to someone else that is testing it without calibration?</p></li>
</ol>
</li>
</ul>
<p>To simulate these situations, we record data from two different users (rr and mg) and in two different sessions (s1 or s2). The user put the bracelet before every session and remove it after every session.</p>
<p>Quick description of the data:</p>
<ul class="simple">
<li><p>Each row corresponds to one acquisition, there is an acquisition every ~4 ms for 8 electrodes which correspond to a 250Hz acquisition rate.</p></li>
<li><p>The time column is in ms.</p></li>
<li><p>The columns c0 to c7 correspond to the electrical value recorded at each of the 8 electrodes (arbitrary unit).</p></li>
<li><p>The label correspond to the sign being recorded by the user at this time point (‘rest’, ‘rock’, ‘paper’, ‘scissors’, or ‘ok). ‘rest’ correspond to a rested arm.</p></li>
<li><p>the exp identify the user (rr and mg) and the session (s1 or s2)</p></li>
</ul>
<p>Note: Another interesting use case, not explored in this notebook, would be to test what is the accruacy when calibrating, removing the armband and giving it to someone else that is calibrating it on its own arm before testing it. The idea being that transfer learning might help getting better results (or faster calibration) than calibrating on one user.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">geomstats.backend</span> <span class="k">as</span> <span class="nn">gs</span>

<span class="n">gs</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2021</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: Using numpy backend
</pre></div></div>
</div>
</section>
<section id="Parameters">
<h2>Parameters<a class="headerlink" href="#Parameters" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_ELECTRODES</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">N_SIGNS</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</section>
<section id="The-Data">
<h2>The Data<a class="headerlink" href="#The-Data" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geomstats.datasets.utils</span> <span class="k">as</span> <span class="nn">data_utils</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data_utils</span><span class="o">.</span><span class="n">load_emg</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>c0</th>
      <th>c1</th>
      <th>c2</th>
      <th>c3</th>
      <th>c4</th>
      <th>c5</th>
      <th>c6</th>
      <th>c7</th>
      <th>label</th>
      <th>exp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>23</td>
      <td>127</td>
      <td>123</td>
      <td>128</td>
      <td>134</td>
      <td>125</td>
      <td>128</td>
      <td>130</td>
      <td>124</td>
      <td>rest</td>
      <td>mg_s1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>28</td>
      <td>126</td>
      <td>130</td>
      <td>128</td>
      <td>119</td>
      <td>129</td>
      <td>128</td>
      <td>126</td>
      <td>133</td>
      <td>rest</td>
      <td>mg_s1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>32</td>
      <td>129</td>
      <td>130</td>
      <td>127</td>
      <td>125</td>
      <td>129</td>
      <td>129</td>
      <td>127</td>
      <td>130</td>
      <td>rest</td>
      <td>mg_s1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>36</td>
      <td>127</td>
      <td>128</td>
      <td>126</td>
      <td>123</td>
      <td>128</td>
      <td>127</td>
      <td>125</td>
      <td>131</td>
      <td>rest</td>
      <td>mg_s1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>40</td>
      <td>127</td>
      <td>128</td>
      <td>129</td>
      <td>124</td>
      <td>127</td>
      <td>129</td>
      <td>127</td>
      <td>128</td>
      <td>rest</td>
      <td>mg_s1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">N_SIGNS</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">label_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rock&quot;</span><span class="p">,</span> <span class="s2">&quot;scissors&quot;</span><span class="p">,</span> <span class="s2">&quot;paper&quot;</span><span class="p">,</span> <span class="s2">&quot;ok&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">label_list</span><span class="p">):</span>
    <span class="n">sign_df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">label_i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">electrode</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_ELECTRODES</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sign_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">electrode</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">label_i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_12_real_world_applications__emg_sign_classification_in_spd_manifold_10_0.png" src="../_images/notebooks_12_real_world_applications__emg_sign_classification_in_spd_manifold_10_0.png" />
</div>
</div>
<p>We are removing the sign ‘rest’ for the rest of the analysis.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="s2">&quot;rest&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<section id="Preprocessing-into-covariance-matrices">
<h3>Preprocessing into covariance matrices<a class="headerlink" href="#Preprocessing-into-covariance-matrices" title="Link to this heading">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">### Parameters.</span>
<span class="n">N_STEPS</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">LABEL_MAP</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rock&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;scissors&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;paper&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;ok&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">MARGIN</span> <span class="o">=</span> <span class="mi">1000</span>
</pre></div>
</div>
</div>
<p>Unpacking data into arrays for batching</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">),</span>
    <span class="s2">&quot;raw_data&quot;</span><span class="p">:</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="s2">&quot;c</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_ELECTRODES</span><span class="p">)]]),</span>
    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">label</span><span class="p">),</span>
    <span class="s2">&quot;exp&quot;</span><span class="p">:</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">exp</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geomstats.datasets.prepare_emg_data</span> <span class="kn">import</span> <span class="n">TimeSeriesCovariance</span>

<span class="n">cov_data</span> <span class="o">=</span> <span class="n">TimeSeriesCovariance</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">N_STEPS</span><span class="p">,</span> <span class="n">N_ELECTRODES</span><span class="p">,</span> <span class="n">LABEL_MAP</span><span class="p">,</span> <span class="n">MARGIN</span><span class="p">)</span>
<span class="n">cov_data</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We check that these matrics belong to the space of SPD matrices.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geomstats.geometry.spd_matrices</span> <span class="kn">import</span> <span class="n">SPDMatrices</span>

<span class="n">manifold</span> <span class="o">=</span> <span class="n">SPDMatrices</span><span class="p">(</span><span class="n">N_ELECTRODES</span><span class="p">,</span> <span class="n">equip</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">manifold</span><span class="o">.</span><span class="n">belongs</span><span class="p">(</span><span class="n">cov_data</span><span class="o">.</span><span class="n">covs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<section id="Covariances-plot-of-the-euclidean-average">
<h4>Covariances plot of the euclidean average<a class="headerlink" href="#Covariances-plot-of-the-euclidean-average" title="Link to this heading">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">label_i</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cov_data</span><span class="o">.</span><span class="n">label_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">label_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cov_data</span><span class="o">.</span><span class="n">labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sign_cov_mat</span> <span class="o">=</span> <span class="n">cov_data</span><span class="o">.</span><span class="n">covs</span><span class="p">[</span><span class="n">label_ids</span><span class="p">]</span>
    <span class="n">mean_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sign_cov_mat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">mean_cov</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">label_i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_12_real_world_applications__emg_sign_classification_in_spd_manifold_22_0.png" src="../_images/notebooks_12_real_world_applications__emg_sign_classification_in_spd_manifold_22_0.png" />
</div>
</div>
<p>Looking at the euclidean average of the spd matrices for each sign, does not show a striking difference between 3 of our signs (scissors, paper, and ok). Minimum Distance to Mean (MDM) algorithm will probably performed poorly if using euclidean mean here.</p>
</section>
<section id="Covariances-plot-of-the-Frechet-Mean-of-the-affine-invariant-metric">
<h4>Covariances plot of the Frechet Mean of the affine invariant metric<a class="headerlink" href="#Covariances-plot-of-the-Frechet-Mean-of-the-affine-invariant-metric" title="Link to this heading">#</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geomstats.learning.frechet_mean</span> <span class="kn">import</span> <span class="n">FrechetMean</span>
<span class="kn">from</span> <span class="nn">geomstats.geometry.spd_matrices</span> <span class="kn">import</span> <span class="n">SPDAffineMetric</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">manifold</span><span class="o">.</span><span class="n">equip_with_metric</span><span class="p">(</span><span class="n">SPDAffineMetric</span><span class="p">)</span>

<span class="n">mean_affine</span> <span class="o">=</span> <span class="n">FrechetMean</span><span class="p">(</span><span class="n">manifold</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">label_i</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cov_data</span><span class="o">.</span><span class="n">label_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">label_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cov_data</span><span class="o">.</span><span class="n">labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sign_cov_mat</span> <span class="o">=</span> <span class="n">cov_data</span><span class="o">.</span><span class="n">covs</span><span class="p">[</span><span class="n">label_ids</span><span class="p">]</span>
    <span class="n">mean_affine</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">sign_cov_mat</span><span class="p">)</span>
    <span class="n">mean_cov</span> <span class="o">=</span> <span class="n">mean_affine</span><span class="o">.</span><span class="n">estimate_</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">mean_cov</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">label_i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_12_real_world_applications__emg_sign_classification_in_spd_manifold_27_0.png" src="../_images/notebooks_12_real_world_applications__emg_sign_classification_in_spd_manifold_27_0.png" />
</div>
</div>
<p>We see that the average matrices computed using the affine invariant metric are now more differenciated from each other and can potentially give better results, when using MDM to predict the sign linked to a matrix sample.</p>
</section>
</section>
</section>
<section id="Sign-Classification">
<h2>Sign Classification<a class="headerlink" href="#Sign-Classification" title="Link to this heading">#</a></h2>
<p>We are now going to train some classifiers on those matrices to see how we can accurately discriminate these 4 hand positions. The baseline accuracy is defined as the accuracy we get by randomly guessing the signs. In our case, the baseline accuracy is 25%.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hiding the numerous sklearn warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span><span class="nv">tensorflow</span><span class="o">==</span><span class="s2">&quot;2.12.1&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Requirement already satisfied: tensorflow in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (2.12.1)
Requirement already satisfied: absl-py&gt;=1.0.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (1.4.0)
Requirement already satisfied: astunparse&gt;=1.6.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (1.6.3)
Requirement already satisfied: flatbuffers&gt;=2.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (23.5.9)
Requirement already satisfied: gast&lt;=0.4.0,&gt;=0.2.1 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (0.4.0)
Requirement already satisfied: google-pasta&gt;=0.1.1 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (0.2.0)
Requirement already satisfied: grpcio&lt;2.0,&gt;=1.24.3 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (1.54.2)
Requirement already satisfied: h5py&gt;=2.9.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (3.8.0)
Requirement already satisfied: jax&gt;=0.3.15 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (0.4.10)
Requirement already satisfied: keras&lt;2.13,&gt;=2.12.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (2.12.0)
Requirement already satisfied: libclang&gt;=13.0.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (16.0.0)
Requirement already satisfied: numpy&lt;=1.24.3,&gt;=1.22 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (1.24.3)
Requirement already satisfied: opt-einsum&gt;=2.3.2 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (3.3.0)
Requirement already satisfied: packaging in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (23.1)
Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;5.0.0dev,&gt;=3.20.3 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (4.23.1)
Requirement already satisfied: setuptools in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (67.7.2)
Requirement already satisfied: six&gt;=1.12.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (1.16.0)
Requirement already satisfied: tensorboard&lt;2.13,&gt;=2.12 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (2.12.3)
Requirement already satisfied: tensorflow-estimator&lt;2.13,&gt;=2.12.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (2.12.0)
Requirement already satisfied: termcolor&gt;=1.1.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (2.3.0)
Requirement already satisfied: typing-extensions&lt;4.6.0,&gt;=3.6.6 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (4.5.0)
Requirement already satisfied: wrapt&lt;1.15,&gt;=1.11.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (1.14.1)
Requirement already satisfied: tensorflow-io-gcs-filesystem&gt;=0.23.1 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorflow) (0.32.0)
Requirement already satisfied: wheel&lt;1.0,&gt;=0.23.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from astunparse&gt;=1.6.0-&gt;tensorflow) (0.40.0)
Requirement already satisfied: ml-dtypes&gt;=0.1.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from jax&gt;=0.3.15-&gt;tensorflow) (0.1.0)
Requirement already satisfied: scipy&gt;=1.7 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from jax&gt;=0.3.15-&gt;tensorflow) (1.11.0)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (2.18.1)
Requirement already satisfied: google-auth-oauthlib&lt;1.1,&gt;=0.5 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (1.0.0)
Requirement already satisfied: markdown&gt;=2.6.8 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (3.4.3)
Requirement already satisfied: requests&lt;3,&gt;=2.21.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (2.31.0)
Requirement already satisfied: tensorboard-data-server&lt;0.8.0,&gt;=0.7.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (0.7.0)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (2.3.4)
Requirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (5.3.0)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (0.3.0)
Requirement already satisfied: urllib3&lt;2.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (1.26.16)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (4.9)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from google-auth-oauthlib&lt;1.1,&gt;=0.5-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (1.3.1)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (3.1.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (3.4)
Requirement already satisfied: certifi&gt;=2017.4.17 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from requests&lt;3,&gt;=2.21.0-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (2023.5.7)
Requirement already satisfied: MarkupSafe&gt;=2.1.1 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from werkzeug&gt;=1.0.1-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (2.1.2)
Requirement already satisfied: pyasn1&lt;0.6.0,&gt;=0.4.6 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (0.5.0)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /user/lgomespe/home/miniconda3/envs/geomstats11/lib/python3.11/site-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;1.1,&gt;=0.5-&gt;tensorboard&lt;2.13,&gt;=2.12-&gt;tensorflow) (3.2.2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.wrappers.scikit_learn</span> <span class="kn">import</span> <span class="n">KerasClassifier</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-07-10 14:16:10.546791: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-07-10 14:16:11.248059: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
</pre></div></div>
</div>
<p>N_EPOCHS is the number of epochs on which to train the MLP. Recommended is ~100</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_EPOCHS</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">N_FEATURES</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N_ELECTRODES</span> <span class="o">*</span> <span class="p">(</span><span class="n">N_ELECTRODES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="A.-Test-on-the-same-session-and-user-as-Training/Calibration">
<h3>A. Test on the same session and user as Training/Calibration<a class="headerlink" href="#A.-Test-on-the-same-session-and-user-as-Training/Calibration" title="Link to this heading">#</a></h3>
<p>In this first part we are training our model on the same session that we are testing it on. In real life, it corresponds to a user calibrating his armband right before using it. To do this, we are splitting every session in k-folds, training on <span class="math notranslate nohighlight">\((k-1)\)</span> fold to test on the <span class="math notranslate nohighlight">\(k^{th}\)</span> last fold.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ExpResults</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class handling the score collection and plotting among the different experiments.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exps</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exps</span> <span class="o">=</span> <span class="n">exps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_ids</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Compute the index corresponding to each session only once at initialization.</span>
        <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exps</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exp_ids</span><span class="p">[</span><span class="n">exp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exps</span> <span class="o">==</span> <span class="n">exp</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">add_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the results from the cross validated pipeline.</span>

<span class="sd">        For the model &#39;pipeline&#39;, it will add the cross validated results of every session in the model_name</span>
<span class="sd">        entry of self.results.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model_name : str</span>
<span class="sd">            Name of the pipeline/model that we are adding results from.</span>
<span class="sd">        model : sklearn.pipeline.Pipeline</span>
<span class="sd">            sklearn pipeline that we are evaluating.</span>
<span class="sd">        X : array</span>
<span class="sd">            data that we are ingesting in the pipeline.</span>
<span class="sd">        y : array</span>
<span class="sd">            labels corresponding to the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;fit_time&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;score_time&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;test_score&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;train_score&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_ids</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_ids</span><span class="p">[</span><span class="n">exp</span><span class="p">]</span>
            <span class="n">exp_result</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span>
                <span class="n">pipeline</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">ids</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">ids</span><span class="p">],</span> <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">exp_result</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">exp_result</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Average training score: </span><span class="si">{:.4f}</span><span class="s2">, Average test score: </span><span class="si">{:.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">][</span><span class="s2">&quot;train_score&quot;</span><span class="p">]),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">][</span><span class="s2">&quot;test_score&quot;</span><span class="p">]),</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_results</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">title</span><span class="p">,</span>
        <span class="n">variables</span><span class="p">,</span>
        <span class="n">err_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">save_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Acc&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot bar plot comparing the different pipelines&#39; results.</span>

<span class="sd">        Compare the results added previously using the &#39;add_result&#39; method with bar plots.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        title : str</span>
<span class="sd">            Title of the plot.</span>
<span class="sd">        variables : list of array</span>
<span class="sd">            List of the variables to plot (e.g. train_score, test_score,...)</span>
<span class="sd">        err_bar : list of float</span>
<span class="sd">            list of error to use for plotting error bars. If None, std is used by default.</span>
<span class="sd">        save_name : str</span>
<span class="sd">            path to save the plot. If None, plot is not saved.</span>
<span class="sd">        xlabel : str</span>
<span class="sd">            Label of the x-axis.</span>
<span class="sd">        ylabel : str</span>
<span class="sd">            Label of the y-axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">### Some defaults parameters.</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;gray&quot;</span><span class="p">]</span>

        <span class="c1">### Reshaping the results for plotting.</span>
        <span class="n">x_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">list_vec</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
            <span class="n">list_vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">variable</span><span class="p">]</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">x_labels</span><span class="p">]</span>
                <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="n">rand_m1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">size</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="c1">### Plots parameters.</span>
        <span class="n">label_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_labels</span><span class="p">))</span>
        <span class="n">center_bar</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_vec</span><span class="p">))]</span>

        <span class="c1">### Plots values.</span>
        <span class="n">avg_vec</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">list_vec</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">err_bar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">err_bar</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">list_vec</span><span class="p">]</span>

        <span class="c1">### Plotting the data.</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vec</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">list_vec</span><span class="p">):</span>
            <span class="n">label_i</span> <span class="o">=</span> <span class="n">variable</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (n = </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vec</span><span class="p">))</span>
            <span class="n">rects</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
                <span class="n">label_loc</span> <span class="o">+</span> <span class="n">center_bar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">avg_vec</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">w</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="n">label_i</span><span class="p">,</span>
                <span class="n">yerr</span><span class="o">=</span><span class="n">err_bar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">label_loc</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">center_bar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">rand_m1</span><span class="p">(</span><span class="n">vec</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="n">w</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span>
                    <span class="n">vec</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="c1"># Add some text for labels, title and custom x-axis tick labels, etc.</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">label_loc</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">x_labels</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="c1">### Saving the figure with a timestamp as a name.</span>
        <span class="k">if</span> <span class="n">save_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp_arr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">cov_data</span><span class="o">.</span><span class="n">batches</span><span class="p">]</span>
<span class="n">intra_sessions_results</span> <span class="o">=</span> <span class="n">ExpResults</span><span class="p">(</span><span class="n">exp_arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="A.0.-Using-Logistic-Regression-on-the-vectorized-Matrix-(Euclidean-Method)">
<h4>A.0. Using Logistic Regression on the vectorized Matrix (Euclidean Method)<a class="headerlink" href="#A.0.-Using-Logistic-Regression-on-the-vectorized-Matrix-(Euclidean-Method)" title="Link to this heading">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;standardize&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s2">&quot;logreg&quot;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s2">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s2">&quot;multinomial&quot;</span><span class="p">)),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">intra_sessions_results</span><span class="o">.</span><span class="n">add_result</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;logreg_eucl&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">covecs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">labels</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average training score: 0.9937, Average test score: 0.9165
</pre></div></div>
</div>
</section>
<section id="A.1.-Using-MLP-on-the-vectorized-Matrix-(Euclidean-Method)">
<h4>A.1. Using MLP on the vectorized Matrix (Euclidean Method)<a class="headerlink" href="#A.1.-Using-MLP-on-the-vectorized-Matrix-(Euclidean-Method)" title="Link to this heading">#</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s2">&quot;initial_weights.hd5&quot;</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="n">N_FEATURES</span><span class="p">,</span> <span class="n">n_signs</span><span class="o">=</span><span class="n">N_SIGNS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function to create model, required for using KerasClassifier and wrapp a Keras model inside a</span>
<span class="sd">    scikitlearn form.</span>
<span class="sd">    We added a weight saving/loading to remove the randomness of the weight initialization (for better comparison).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
                <span class="n">n_features</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_features</span><span class="p">,)</span>
            <span class="p">),</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">),</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">n_signs</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;sparse_categorical_crossentropy&quot;</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;rmsprop&quot;</span><span class="p">,</span>
        <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="s2">&quot;initial_weights.hd5&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>


<span class="k">def</span> <span class="nf">create_model_covariance</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s2">&quot;initial_weights.hd5&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">create_model</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="n">N_FEATURES</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Use the line below to generate the ‘initial_weights.hd5’ file</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">generate_weights</span> <span class="o">=</span> <span class="n">create_model</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2023-07-10 14:16:12.296854: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-07-10 14:16:12.297613: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1956] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;standardize&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s2">&quot;mlp&quot;</span><span class="p">,</span> <span class="n">KerasClassifier</span><span class="p">(</span><span class="n">build_fn</span><span class="o">=</span><span class="n">create_model</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">N_EPOCHS</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">intra_sessions_results</span><span class="o">.</span><span class="n">add_result</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;mlp_eucl&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">covecs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">labels</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average training score: 0.9563, Average test score: 0.8284
</pre></div></div>
</div>
</section>
<section id="A.2.-Using-Tangent-space-projection-+-Logistic-Regression">
<h4>A.2. Using Tangent space projection + Logistic Regression<a class="headerlink" href="#A.2.-Using-Tangent-space-projection-+-Logistic-Regression" title="Link to this heading">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geomstats.learning.preprocessing</span> <span class="kn">import</span> <span class="n">ToTangentSpace</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;feature_ext&quot;</span><span class="p">,</span> <span class="n">ToTangentSpace</span><span class="p">(</span><span class="n">manifold</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;standardize&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s2">&quot;logreg&quot;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s2">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s2">&quot;multinomial&quot;</span><span class="p">)),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">intra_sessions_results</span><span class="o">.</span><span class="n">add_result</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;logreg_affinvariant_tangent&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span>
    <span class="n">X</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">covs</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average training score: 0.9959, Average test score: 0.9200
</pre></div></div>
</div>
</section>
<section id="A.3.-Using-Tangent-space-projection-+-MLP">
<h4>A.3. Using Tangent space projection + MLP<a class="headerlink" href="#A.3.-Using-Tangent-space-projection-+-MLP" title="Link to this heading">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;feature_ext&quot;</span><span class="p">,</span> <span class="n">ToTangentSpace</span><span class="p">(</span><span class="n">manifold</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;standardize&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span>
            <span class="s2">&quot;mlp&quot;</span><span class="p">,</span>
            <span class="n">KerasClassifier</span><span class="p">(</span>
                <span class="n">build_fn</span><span class="o">=</span><span class="n">create_model_covariance</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">N_EPOCHS</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">intra_sessions_results</span><span class="o">.</span><span class="n">add_result</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;mlp_affinvariant_tangent&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span>
    <span class="n">X</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">covs</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average training score: 0.9694, Average test score: 0.8489
</pre></div></div>
</div>
</section>
<section id="A.4.-Using-Euclidean-MDM">
<h4>A.4. Using Euclidean MDM<a class="headerlink" href="#A.4.-Using-Euclidean-MDM" title="Link to this heading">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geomstats.learning.mdm</span> <span class="kn">import</span> <span class="n">RiemannianMinimumDistanceToMean</span>
<span class="kn">from</span> <span class="nn">geomstats.geometry.spd_matrices</span> <span class="kn">import</span> <span class="n">SPDEuclideanMetric</span>

<span class="n">manifold</span><span class="o">.</span><span class="n">equip_with_metric</span><span class="p">(</span><span class="n">SPDEuclideanMetric</span><span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span>
            <span class="s2">&quot;clf&quot;</span><span class="p">,</span>
            <span class="n">RiemannianMinimumDistanceToMean</span><span class="p">(</span><span class="n">manifold</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">intra_sessions_results</span><span class="o">.</span><span class="n">add_result</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;mdm_eucl&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">covs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">labels</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average training score: 0.8498, Average test score: 0.7999
</pre></div></div>
</div>
</section>
<section id="A.5.-Using-Riemannian-MDM">
<h4>A.5. Using Riemannian MDM<a class="headerlink" href="#A.5.-Using-Riemannian-MDM" title="Link to this heading">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span>
            <span class="s2">&quot;clf&quot;</span><span class="p">,</span>
            <span class="n">RiemannianMinimumDistanceToMean</span><span class="p">(</span><span class="n">manifold</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">intra_sessions_results</span><span class="o">.</span><span class="n">add_result</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;mdm_affinvariant&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">covs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">cov_data</span><span class="o">.</span><span class="n">labels</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average training score: 0.8498, Average test score: 0.7999
</pre></div></div>
</div>
</section>
<section id="Summary-plots">
<h4>Summary plots<a class="headerlink" href="#Summary-plots" title="Link to this heading">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intra_sessions_results</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="s2">&quot;intra_sess&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;test_score&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_12_real_world_applications__emg_sign_classification_in_spd_manifold_56_0.png" src="../_images/notebooks_12_real_world_applications__emg_sign_classification_in_spd_manifold_56_0.png" />
</div>
</div>
</section>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="11_real_world_applications__cell_shapes_analysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Shape Analysis of Cancer Cells</p>
      </div>
    </a>
    <a class="right-next"
       href="13_real_world_applications__graph_embedding_and_clustering_in_hyperbolic_space.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Hyperbolic Embedding of Graphs and Clustering</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Context">Context</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Parameters">Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#The-Data">The Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Preprocessing-into-covariance-matrices">Preprocessing into covariance matrices</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Covariances-plot-of-the-euclidean-average">Covariances plot of the euclidean average</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Covariances-plot-of-the-Frechet-Mean-of-the-affine-invariant-metric">Covariances plot of the Frechet Mean of the affine invariant metric</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Sign-Classification">Sign Classification</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#A.-Test-on-the-same-session-and-user-as-Training/Calibration">A. Test on the same session and user as Training/Calibration</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#A.0.-Using-Logistic-Regression-on-the-vectorized-Matrix-(Euclidean-Method)">A.0. Using Logistic Regression on the vectorized Matrix (Euclidean Method)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#A.1.-Using-MLP-on-the-vectorized-Matrix-(Euclidean-Method)">A.1. Using MLP on the vectorized Matrix (Euclidean Method)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#A.2.-Using-Tangent-space-projection-+-Logistic-Regression">A.2. Using Tangent space projection + Logistic Regression</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#A.3.-Using-Tangent-space-projection-+-MLP">A.3. Using Tangent space projection + MLP</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#A.4.-Using-Euclidean-MDM">A.4. Using Euclidean MDM</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#A.5.-Using-Riemannian-MDM">A.5. Using Riemannian MDM</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Summary-plots">Summary plots</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/notebooks/12_real_world_applications__emg_sign_classification_in_spd_manifold.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022-2023, Geomstats, Inc..
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>