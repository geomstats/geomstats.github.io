
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Computing with triangular shapes in Kendall framework &#8212; Geomstats latest documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/16_real_world_applications__visualizations_in_kendall_shape_spaces';</script>
    <link rel="canonical" href="geomstats.github.io/notebooks/16_real_world_applications__visualizations_in_kendall_shape_spaces.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Optimization of Sao Paulo traffic" href="18_real_world_applications__sao_paulo_traffic_optimization.html" />
    <link rel="prev" title="Computing with shapes of landmarks in Kendall shape spaces" href="15_real_world_applications__optic_nerve_heads_analysis_in_kendall_shape_space.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">Geomstats latest documentation</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation/index.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../tutorials/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API Reference
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../roadmap.html">
                        Roadmap
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../governance.html">
                        Governance
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../gsod.html">
                        Google Season of Docs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../hackathons.html">
                        Hackathons
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation/index.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../tutorials/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API Reference
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../roadmap.html">
                        Roadmap
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../governance.html">
                        Governance
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../gsod.html">
                        Google Season of Docs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../hackathons.html">
                        Hackathons
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="03_practical_methods__data_on_manifolds.html">Data on Manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_practical_methods__from_vector_spaces_to_manifolds.html">From vector spaces to manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_practical_methods__simple_machine_learning_on_tangent_spaces.html">Learning on Tangent Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_practical_methods__riemannian_frechet_mean_and_tangent_pca.html">Fréchet Mean and Tangent PCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_practical_methods__riemannian_kmeans.html">K-Means clustering on a Riemannian Manifold</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_practical_methods__information_geometry.html">Information geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_practical_methods__implement_your_own_riemannian_geometry.html">Implement your own Riemannian Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_practical_methods__shape_analysis.html">Shape analysis of curves with the Square Root Velocity metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="19_practical_methods__aac.html">Align all and Compute for Graphs</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="11_real_world_applications__cell_shapes_analysis.html">Shape Analysis of Cancer Cells</a></li>









<li class="toctree-l1"><a class="reference internal" href="12_real_world_applications__emg_sign_classification_in_spd_manifold.html">Hand gesture classification with EMG data using Riemannian metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_real_world_applications__graph_embedding_and_clustering_in_hyperbolic_space.html">Hyperbolic Embedding of Graphs and Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_real_world_applications__hand_poses_analysis_in_kendall_shape_space.html">Classifying hands poses with Kendall shape spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_real_world_applications__optic_nerve_heads_analysis_in_kendall_shape_space.html">Computing with shapes of landmarks in Kendall shape spaces</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Computing with triangular shapes in Kendall framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_real_world_applications__sao_paulo_traffic_optimization.html">Optimization of Sao Paulo traffic</a></li>






</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="admonition note">
  <p>Notebook source code:
    <a class="reference external" href="https://github.com/geomstats/geomstats/blob/master/notebooks/16_real_world_applications__visualizations_in_kendall_shape_spaces.ipynb">notebooks/16_real_world_applications__visualizations_in_kendall_shape_spaces.ipynb</a>
    <br>Run it yourself on binder
    <a href="https://mybinder.org/v2/gh/geomstats/geomstats/master?filepath=notebooks/16_real_world_applications__visualizations_in_kendall_shape_spaces.ipynb"><img alt="Binder badge"
    src="https://mybinder.org/badge_logo.svg"
    style="vertical-align:text-bottom"></a>
  </p>
</div><section id="Computing-with-triangular-shapes-in-Kendall-framework">
<h1>Computing with triangular shapes in Kendall framework<a class="headerlink" href="#Computing-with-triangular-shapes-in-Kendall-framework" title="Permalink to this heading">#</a></h1>
<p>Lead author: Elodie Maignant.</p>
<p>David G. Kendall first took interest into triangular shapes while studying random alignments of points in archeology and related fields <a class="reference external" href="#References">[KK1980]</a>. Following this statistical study, he developped the more general theory of shapes. This theory echoes in many fields like biology, medicine, or image analysis, where the shape of an object is particularly relevant when it comes to its analysis. Since the deformation of a shape is not necessarely linear, we need to use geometric
statistics in order to proceed with such data.</p>
<p>In Kendall theory, the word shape is used in the common sense, refering to the appearance of an object. Since the shape of an object should not depend on the way it is looked at or computed, it is natural to remove location, rotationnal and eventually scale effects. A practical way of describing an object’s shape is to locate a finite number of relevant points on it, which we call landmarks, which should summarize the geometrical and/or scientifical information <a class="reference external" href="#References">[DM2016]</a>.</p>
<p>Thus we define Kendall shape space of order <span class="math notranslate nohighlight">\((k,m)\)</span> (where <span class="math notranslate nohighlight">\(k\geq 2\)</span>) as the quotient of <span class="math notranslate nohighlight">\(k\)</span>-tuples of non-aligned points in <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> by the group of rotations, translations and dilatations of <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> :</p>
<div class="math notranslate nohighlight">
\[\big(\Sigma^k_m\triangleq\mathbb{R}^{km}\setminus \Delta \big)/\big(\mathbb{R_+^*}\times SO(m)\ltimes \mathbb{R}^m\big)\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta =\{\ (a)_{1\leq i\leq k}\ |\ a\in\mathbb{R}^m\}\)</span> correspond to the degenerate case where all landmarks collapse into a unique point.</p>
<p>It is useful to see that considering first the action of translations and dilatations before applying rotation group <span class="math notranslate nohighlight">\(\text{SO}\)</span> allows to write :</p>
<div class="math notranslate nohighlight">
\[\Sigma^k_m=\mathcal{S}^k_m/ \text{SO}(m)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{S}^k_m\)</span>, called the pre-shape space of order <span class="math notranslate nohighlight">\((k,m)\)</span> denotes the space of centered and normalized <span class="math notranslate nohighlight">\(k\)</span>-tuples of in <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span>. It corresponds to the unit sphere of dimension <span class="math notranslate nohighlight">\(k(m-1)\)</span> <a class="reference external" href="#References">[K1984]</a>.</p>
<p>The Kendall shape space of order <span class="math notranslate nohighlight">\((k,m)\)</span> is a differential manifold which acquires singularities as soon as <span class="math notranslate nohighlight">\(m\geq 3\)</span>. Apart from these singularities, it is a smooth manifold which can be equipped with a Riemannian metric inherited from the Frobenius metric on the pre-shape space <a class="reference external" href="#References">[LK1993]</a>.</p>
<p>In this tutorial, we take a deeper look at two specific cases of Kendall shape spaces : the space <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span> of 2D triangles and the space <span class="math notranslate nohighlight">\(\Sigma^3_3\)</span> of 3D triangles. These two spaces are particularly interesting to look at because there exists a projection such that we can directly visualize them.</p>
<p>The tutorial is organized as follows :</p>
<ul class="simple">
<li><p>First, we present the case of 2D triangles, and illustrate some geometric tools with a dedicated visualization class.</p></li>
<li><p>Then, following the same scheme, we look at the 3D case.</p></li>
<li><p>Finally, we explore these visualizations with the dataset of the optical nerves head</p></li>
</ul>
<section id="Set-up">
<h2>Set up<a class="headerlink" href="#Set-up" title="Permalink to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import os
import sys
import warnings

sys.path.append(os.path.dirname(os.getcwd()))
warnings.filterwarnings(&quot;ignore&quot;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%matplotlib inline

import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

import geomstats.backend as gs
import geomstats.datasets.utils as data_utils
from geomstats.geometry.pre_shape import KendallShapeMetric, PreShapeSpace
from geomstats.visualization import KendallDisk, KendallSphere
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: Using numpy backend
</pre></div></div>
</div>
</section>
<section id="The-space-\Sigma_2^3-of-2D-triangles">
<h2>The space <span class="math notranslate nohighlight">\(\Sigma_2^3\)</span> of 2D triangles<a class="headerlink" href="#The-space-\Sigma_2^3-of-2D-triangles" title="Permalink to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>m_ambient = 2
k_landmarks = 3
preshape_triangle_2d = PreShapeSpace(3, 2)
metric_triangle_2d = KendallShapeMetric(3, 2)
</pre></div>
</div>
</div>
<p>The space <span class="math notranslate nohighlight">\(\Sigma_2^3\)</span> of 2D triangles is a manifold of dimension <span class="math notranslate nohighlight">\(2=3\times(2-1)-1\)</span>. Kendall showed that it is isometric to the <span class="math notranslate nohighlight">\(2\)</span>-sphere of radius <span class="math notranslate nohighlight">\(1/2\)</span> <a class="reference external" href="#References">[K1984]</a>. Such an isometry can be computed explicitly. Practically, this means that 2D triangular shape datasets can be directly visualized in 3D without losing any information (especially geometrical ones). Furthermore, all geometric statistics can be directly processed on the sphere, for which we
already have a large catalogue of explicit methods.</p>
<p>First step consist in projecting (via the isometry mentionned above) the triangles on the sphere. In order to visualize better how the space <span class="math notranslate nohighlight">\(\Sigma_2^3\)</span> is mapped onto the sphere <span class="math notranslate nohighlight">\(S^2(1/2)\)</span>, we plot regularly sampled triangles at their corresponding location (according to the projection).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>S = KendallSphere()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(15, 15))
S.draw()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_11_0.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_11_0.png" />
</div>
</div>
<p>One can easily notice that the equator corresponds to flat triangles while first meridian is paired with the subset of isocele triangles whose apex is red.</p>
<p>We now illustrate how some essential statistic and geometric tools project on the sphere.</p>
</section>
<section id="Uniform-distribution">
<h2>Uniform distribution<a class="headerlink" href="#Uniform-distribution" title="Permalink to this heading">#</a></h2>
<p>Since the projection is isometric, the uniform distribution in <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span> is exactly the uniform distribution on the sphere.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(15, 15))
S.draw()

points = preshape_triangle_2d.random_uniform(1000)

S.clear_points()
S.add_points(points)
S.draw_points(color=&quot;k&quot;, s=2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_16_0.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_16_0.png" />
</div>
</div>
</section>
<section id="Geodesic">
<h2>Geodesic<a class="headerlink" href="#Geodesic" title="Permalink to this heading">#</a></h2>
<p>The geodesics in <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span> corresponds to great circles on the sphere. The distance between two triangles of <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span> is given exactly by the arc-length of the arc joining the two projected points on the sphere. The diameter of the space <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span>, defined as the distance between the two most distant points, is then equal to <span class="math notranslate nohighlight">\(\pi/2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(15, 15))
S.draw()

times = gs.linspace(0.0, 1.0, 1000)
velocities = gs.array([-t * 0.5 * S.ub for t in times])
points = metric_triangle_2d.exp(velocities, S.pole)

S.clear_points()
S.add_points(points)
S.draw_curve(color=&quot;b&quot;, lw=3)
S.clear_points()
S.add_points(points[[0, -1]])
S.draw_points(color=&quot;k&quot;, s=70)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_19_0.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_19_0.png" />
</div>
</div>
</section>
<section id="Parallel-transport">
<h2>Parallel transport<a class="headerlink" href="#Parallel-transport" title="Permalink to this heading">#</a></h2>
<p>Given the geodesics and the logarithm map, one can easily compute the parallel transport of a vector <span class="math notranslate nohighlight">\(w\)</span> along the geodesic <span class="math notranslate nohighlight">\(\exp_\text{b.p.}(tv)\)</span> using the Pole Ladder algorithm implemented in geomstats.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>base_point, v, w = S.pole, -0.5 * S.ub, S.ua
n_rungs = 10
ladder = metric_triangle_2d.ladder_parallel_transport(
    w, base_point, v, n_rungs, return_geodesics=True
)

transported = ladder[&quot;transported_tangent_vec&quot;]
end_point = ladder[&quot;end_point&quot;]
trajectory = ladder[&quot;trajectory&quot;]

n_points = 10
t = gs.linspace(0.0, 1.0, n_points)
t_main = gs.linspace(0.0, 1.0, n_points * 4)
main = []
diag = []
for points in trajectory:
    main_geodesic, diagonal, final_geodesic = points
    main.append(main_geodesic(t_main))
    diag.append(diagonal(-t))
    diag.append(diagonal(t))

diag = gs.stack(diag).reshape(-1, k_landmarks, m_ambient)
main = gs.stack(main).reshape(-1, k_landmarks, m_ambient)

tangent_vectors = [v / n_rungs, w / n_rungs, transported / n_rungs]
base_points = [base_point, base_point, main[-1]]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(15, 15))
S.draw()

S.clear_points()
S.add_points(main)
S.draw_curve(color=&quot;b&quot;, lw=3)
S.clear_points()
S.add_points(diag)
S.draw_points(color=&quot;r&quot;, s=2)
for bp, tv in zip(base_points, tangent_vectors):
    S.draw_vector(tv, bp, color=(0, 1, 0), lw=3)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_23_0.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_23_0.png" />
</div>
</div>
<p>The diagonal geodesics used by the Pole Ladder method to compute the parallel transport are plotted in red.</p>
<p>In the specific case of Kendall shape spaces, one can use a second method, based on an integration scheme. This method follows the result of <a class="reference external" href="#References">[KDLS2021]</a> giving conditions on a vector field in the top space <span class="math notranslate nohighlight">\(\mathcal S^k_m\)</span> for its projection to be the parallel transport in the shape space <span class="math notranslate nohighlight">\(\Sigma^k_m\)</span>. The implementation of the method can be found in the
<a class="reference external" href="https://github.com/geomstats/geomstats/blob/f9f669551faeaf8c23f347b57d1ce3970eacbe3a/geomstats/geometry/pre_shape.py#L569">KendallShapeMetric</a> and is described along with its comparison to the Pole Ladder method in <a class="reference external" href="#References">[GMTP21]</a>.</p>
</section>
<section id="The-space-\Sigma_3^3-of-3D-triangles">
<h2>The space <span class="math notranslate nohighlight">\(\Sigma_3^3\)</span> of 3D triangles<a class="headerlink" href="#The-space-\Sigma_3^3-of-3D-triangles" title="Permalink to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>m_ambient = 3
k_landmarks = 3
preshape_triangle_3d = PreShapeSpace(3, 3)
metric_triangle_3d = KendallShapeMetric(3, 3)
</pre></div>
</div>
</div>
<p>Once we know that <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span> is isometric to the <span class="math notranslate nohighlight">\(2\)</span>-shere of radius <span class="math notranslate nohighlight">\(1/2\)</span>, it follows that the space <span class="math notranslate nohighlight">\(\Sigma_3^3\)</span> of 3D triangles is then isometric to the <span class="math notranslate nohighlight">\(1\)</span>-ball of radius <span class="math notranslate nohighlight">\(\pi/4\)</span>. More generally, for <span class="math notranslate nohighlight">\(m\geq k\)</span>, the space <span class="math notranslate nohighlight">\(\Sigma^k_m\)</span> is isometric to the quotient <span class="math notranslate nohighlight">\(\Sigma^k_{k-1}/\mathbb{Z}_2\)</span> <a class="reference external" href="#References">[LK1993]</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>D = KendallDisk()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(15, 15))
D.draw()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_30_0.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_30_0.png" />
</div>
</div>
<p>The shape space <span class="math notranslate nohighlight">\(\Sigma_3^3\)</span> is a manifold with boundary, which coincides with its singularity. We see on the above figure that it corresponds to set of flat triangles, which was located on the equator in the case of <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>flat = gs.array([[0.0, 0.0, 0.0], [1.0, 0.0, 0.0], [-1.0, 0.0, 0.0]]) / gs.sqrt(2.0)

preshape_triangle_3d.align(flat, D.centre)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: Singularity close, ill-conditioned matrix encountered: [0.]
WARNING: Alignment matrix is not unique.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [ 8.89809642e-18,  7.07106781e-01,  0.00000000e+00],
       [-8.89809642e-18, -7.07106781e-01,  0.00000000e+00]])
</pre></div></div>
</div>
</section>
<section id="id1">
<h2>Uniform distribution<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>As in the previous example, the uniform distribution on <span class="math notranslate nohighlight">\(\Sigma^3_3\)</span> is given exactly by the uniform distribution on a disk.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(15, 15))
D.draw()

points = preshape_triangle_3d.random_uniform(1000)

D.clear_points()
D.add_points(points)
D.draw_points(color=&quot;k&quot;, s=2)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_35_0.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_35_0.png" />
</div>
</div>
</section>
<section id="Geodesics">
<h2>Geodesics<a class="headerlink" href="#Geodesics" title="Permalink to this heading">#</a></h2>
<p>We show a first example where the geodesic is radial. It is the projection of the geodesic we previously shot in <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(15, 15))
D.draw()

times = gs.linspace(0.0, 1.0, 1000)
ub_3d = gs.transpose(gs.stack((D.ub[:, 0], D.ub[:, 1], gs.zeros(3))))
speeds = gs.array([-t * 0.5 * ub_3d for t in times])
points = metric_triangle_3d.exp(speeds, D.centre)

D.clear_points()
D.add_points(points)
D.draw_curve(color=&quot;b&quot;, lw=3)
D.clear_points()
D.add_points(points[[0, -1]])
D.draw_points(color=&quot;k&quot;, s=70)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_38_0.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_38_0.png" />
</div>
</div>
<p>We show a second example where the initial point is no more the equilateral triangle.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(15, 15))
D.draw()

times = gs.linspace(0.0, 1.0, 1000)
base_point = preshape_triangle_3d.projection(D.centre + 0.35 * ub_3d)
tangent_vec = preshape_triangle_3d.to_tangent(
    preshape_triangle_3d.random_point(), base_point
)
tangent_vec = 0.5 * tangent_vec / metric_triangle_3d.norm(tangent_vec, base_point)
speeds = gs.array([t * tangent_vec for t in times])
points = metric_triangle_3d.exp(speeds, base_point)

D.clear_points()
D.add_points(points)
D.draw_curve(color=&quot;b&quot;, lw=3)
D.clear_points()
D.add_points(points[[0, -1]])
D.draw_points(color=&quot;k&quot;, s=70)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_40_0.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_40_0.png" />
</div>
</div>
</section>
<section id="id2">
<h2>Parallel transport<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>We compute the parallel transport of an orthogonal vector <span class="math notranslate nohighlight">\(w\)</span> along the previous geodesic using the Pole Ladder method.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>base_point = base_point
v = tangent_vec
w = preshape_triangle_3d.to_tangent(preshape_triangle_3d.random_point(), base_point)
w = (
    w
    - metric_triangle_3d.inner_product(w, 2.0 * tangent_vec, base_point)
    * 2.0
    * tangent_vec
)
w = w / metric_triangle_3d.norm(w, base_point)
n_rungs = 10
ladder = metric_triangle_3d.ladder_parallel_transport(
    w, base_point, v, n_rungs, return_geodesics=True
)

transported = ladder[&quot;transported_tangent_vec&quot;]
end_point = ladder[&quot;end_point&quot;]
trajectory = ladder[&quot;trajectory&quot;]

n_points = 10
t = gs.linspace(0.0, 1, n_points)
t_main = gs.linspace(0.0, 1.0, n_points * 4)
main = []
diag = []
for points in trajectory:
    main_geodesic, diagonal, final_geodesic = points
    main.append(main_geodesic(t_main))
    diag.append(diagonal(-t))
    diag.append(diagonal(t))

diag = gs.stack(diag).reshape(-1, k_landmarks, m_ambient)
main = gs.stack(main).reshape(-1, k_landmarks, m_ambient)

tangent_vectors = [v / n_rungs, w / n_rungs, transported / n_rungs]
base_points = [base_point, base_point, main[-1]]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(15, 15))
D.draw()

D.clear_points()
D.add_points(main)
D.draw_curve(color=&quot;b&quot;, lw=3)
D.clear_points()
D.add_points(diag)
D.draw_points(color=&quot;r&quot;, s=1)
for bp, vec in zip(base_points, tangent_vectors):
    D.draw_vector(vec, bp, color=(0, 1, 0), width=0.003)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_44_0.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_44_0.png" />
</div>
</div>
</section>
<section id="Usecase-:-optical-nerve-heads">
<h2>Usecase : optical nerve heads<a class="headerlink" href="#Usecase-:-optical-nerve-heads" title="Permalink to this heading">#</a></h2>
<p>In this usecase, we will illustrate how to use this last visualization class while investigating if there is a difference between two groups :</p>
<ul class="simple">
<li><p>optical nerve heads that correspond to normal eyes,</p></li>
<li><p>optical nerve heads that correspond to glaucoma eyes.</p></li>
</ul>
<p>We import the dataset of the optical nerve heads from 22 images of Rhesus monkeys’ eyes (11 monkeys), available in [PE2015].</p>
<p>For each monkey, an experimental glaucoma was introduced in one eye, while the second eye was kept as control. One seeks to observe differences between the glaucoma and the control eyes. On each image, 5 anatomical landmarks were recorded:</p>
<ul class="simple">
<li><p>1st landmark: superior aspect of the retina,</p></li>
<li><p>2nd landmark: side of the retina closest to the temporal bone of the skull,</p></li>
<li><p>3rd landmark: nose side of the retina,</p></li>
<li><p>4th landmark: inferior point,</p></li>
<li><p>5th landmark: optical nerve head deepest point.</p></li>
</ul>
<p>Label 0 refers to a normal eye, and Label 1 to an eye with glaucoma.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>nerves, labels, monkeys = data_utils.load_optical_nerves()
print(nerves.shape)
print(labels)
print(monkeys)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(22, 5, 3)
[0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1]
[ 0  0  1  1  2  2  3  3  4  4  5  5  6  6  7  7  8  8  9  9 10 10]
</pre></div></div>
</div>
<p>For this study we will consider only 3 first landmarks, such that our dataset is now a set of 22 labeled triangles.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>landmarks = [0, 1, 2]
data = nerves[:, landmarks, :]
</pre></div>
</div>
</div>
<p>We can visualize the dataset on the disk.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>D = KendallDisk(coords_type=&quot;extrinsic&quot;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>normal_points = gs.array([data[i] for i in range(22) if labels[i] == 0])
glaucoma_points = gs.array([data[i] for i in range(22) if labels[i] == 1])

fig = plt.figure(figsize=(15, 15))
D.draw()

D.add_points(normal_points)
D.draw_points(color=(0, 1, 0), s=40, label=&quot;Normal eyes&quot;)
D.clear_points()
glaucoma = D.add_points(glaucoma_points)
D.draw_points(color=(0, 0, 0), s=40, label=&quot;Glaucoma eyes&quot;)

plt.legend(fontsize=&quot;xx-large&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7fe2bc34cb90&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_52_1.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_52_1.png" />
</div>
</div>
<p>We observe that the two sets are very compact and well superimposed. It means that this choice of 3 landmarks isn’t of any help in separating the two groups. Therfore, we choose to include the 5th landmark into the selection and run a new example.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>landmarks = [0, 1, 4]
data = nerves[:, landmarks, :]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>normal_points = gs.array([data[i] for i in range(22) if labels[i] == 0])
glaucoma_points = gs.array([data[i] for i in range(22) if labels[i] == 1])

fig = plt.figure(figsize=(15, 15))
D.draw()

D.clear_points()
D.add_points(normal_points)
D.draw_points(color=(0, 1, 0), s=40, label=&quot;Normal eyes&quot;)
D.clear_points()
glaucoma = D.add_points(glaucoma_points)
D.draw_points(color=(0, 0, 0), s=40, label=&quot;Glaucoma eyes&quot;)

plt.legend(fontsize=&quot;xx-large&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7fe2bc9e6f90&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_55_1.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_55_1.png" />
</div>
</div>
<p>In this example, we observe a bigger variability within the two groups. Even though we can’t separate them visually, they are not superimposed either. To highlight this, we can compute the Frechet mean of each group.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from geomstats.learning.frechet_mean import FrechetMean
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>FM = FrechetMean(metric_triangle_3d)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>normal_mean = FM.fit(preshape_triangle_3d.projection(normal_points)).estimate_
glaucoma_mean = FM.fit(preshape_triangle_3d.projection(glaucoma_points)).estimate_
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig = plt.figure(figsize=(15, 15))
D.draw()

D.clear_points()
D.add_points(normal_points)
D.draw_points(color=(0, 1, 0), s=40, label=&quot;Normal eyes&quot;)
D.clear_points()
glaucoma = D.add_points(glaucoma_points)
D.draw_points(color=(0, 0, 0), s=40, label=&quot;Glaucoma eyes&quot;)
D.clear_points()
D.add_points(normal_mean)
D.draw_points(color=(0, 1, 0), marker=&quot;s&quot;, s=100, label=&quot;Mean of normal eyes&quot;)
D.clear_points()
D.add_points(glaucoma_mean)
D.draw_points(color=(0, 0, 0), marker=&quot;s&quot;, s=100, label=&quot;Mean of glaucoma eyes&quot;)

plt.legend(fontsize=&quot;xx-large&quot;)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7fe2b8185ad0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_60_1.png" src="../_images/notebooks_16_real_world_applications__visualizations_in_kendall_shape_spaces_60_1.png" />
</div>
</div>
<p>We observe that the two means are slightly different.</p>
</section>
<section id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this heading">#</a></h2>
<div role="list" class="citation-list">
<div class="citation" id="kk1980" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>KK1980<span class="fn-bracket">]</span></span>
<p>KENDALL, David G. et KENDALL, Wilfrid S. Alignments in two-dimensional random sets of points. Advances in Applied probability, 1980, p. 380-424. <a class="reference external" href="https://doi.org/10.2307/1426603">https://doi.org/10.2307/1426603</a></p>
</div>
<div class="citation" id="dm2016" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>DM2016<span class="fn-bracket">]</span></span>
<p>DRYDEN, Ian L. et MARDIA, Kanti V. Statistical shape analysis: with applications in R. John Wiley &amp; Sons, 2016. <a class="reference external" href="https://doi.org/10.1002/9781119072492">https://doi.org/10.1002/9781119072492</a></p>
</div>
<div class="citation" id="k1984" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>K1984<span class="fn-bracket">]</span></span>
<p>KENDALL, David G. Shape manifolds, procrustean metrics, and complex projective spaces. Bulletin of the London mathematical society, 1984, vol. 16, no 2, p. 81-121. <a class="reference external" href="https://doi.org/10.1112/blms/16.2.81">https://doi.org/10.1112/blms/16.2.81</a></p>
</div>
<div class="citation" id="lk1993" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>LK1993<span class="fn-bracket">]</span></span>
<p>LE, Huiling, KENDALL, David G., et al.  The Riemannian structure of Euclidean shape spaces: a novel environment for statistics. Annals of statistics, 1993, vol. 21, no 3, p. 1225-1271. <a class="reference external" href="https://doi.org/10.1112/blms/16.2.81">https://doi.org/10.1112/blms/16.2.81</a></p>
</div>
<div class="citation" id="kdls2021" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>KDLS2021<span class="fn-bracket">]</span></span>
<p>KIM, Kwang-Rae, DRYDEN, Ian L., LE, Huiling, SEVERN, Katie E. Smoothing splines on Riemannian manifolds, with applications to 3D shape space. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 2021, vol. 83, no 1, p. 108-132. <a class="reference external" href="https://doi.org/10.1111/rssb.12402">https://doi.org/10.1111/rssb.12402</a></p>
</div>
<div class="citation" id="gmtp2021" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>GMTP2021<span class="fn-bracket">]</span></span>
<p>GUIGUI, Nicolas, MAIGNANT, Elodie, TROUVE, Alain, PENNEC, Xavier. Parallel Transport on Kendall Shape Spaces. 5th conference on Geometric Science of Information, Paris 2021. Lecture Notes in Computer Science. Springer, 2021. <a class="reference external" href="https://hal.inria.fr/hal-03160677">https://hal.inria.fr/hal-03160677</a></p>
</div>
</div>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="15_real_world_applications__optic_nerve_heads_analysis_in_kendall_shape_space.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Computing with shapes of landmarks in Kendall shape spaces</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="18_real_world_applications__sao_paulo_traffic_optimization.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Optimization of Sao Paulo traffic</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Set-up">
   Set up
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#The-space-\Sigma_2^3-of-2D-triangles">
   The space
   <span class="math notranslate nohighlight">
    \(\Sigma_2^3\)
   </span>
   of 2D triangles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Uniform-distribution">
   Uniform distribution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Geodesic">
   Geodesic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Parallel-transport">
   Parallel transport
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#The-space-\Sigma_3^3-of-3D-triangles">
   The space
   <span class="math notranslate nohighlight">
    \(\Sigma_3^3\)
   </span>
   of 3D triangles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Uniform distribution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Geodesics">
   Geodesics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   Parallel transport
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Usecase-:-optical-nerve-heads">
   Usecase : optical nerve heads
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#References">
   References
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../_sources/notebooks/16_real_world_applications__visualizations_in_kendall_shape_spaces.ipynb.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022-2023, Geomstats, Inc..<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>