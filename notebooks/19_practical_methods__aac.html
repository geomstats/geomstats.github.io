
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Align all and Compute for Graphs &#8212; Geomstats latest documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="../_static/documentation_options.js?v=c6e86fd7"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/19_practical_methods__aac';</script>
    <link rel="canonical" href="geomstats.github.io/notebooks/19_practical_methods__aac.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Shape Analysis of Cancer Cells" href="11_real_world_applications__cell_shapes_analysis.html" />
    <link rel="prev" title="Shape analysis of curves with the Square Root Velocity metric" href="10_practical_methods__shape_analysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Nov 29, 2023, 5:14:06â€¯PM"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Geomstats latest documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation/index.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../tutorials/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API Reference
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../roadmap.html">
                        Roadmap
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../governance.html">
                        Governance
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../gsod.html">
                        Google Season of Docs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../hackathons.html">
                        Hackathons
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation/index.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../tutorials/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API Reference
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../roadmap.html">
                        Roadmap
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../governance.html">
                        Governance
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../gsod.html">
                        Google Season of Docs
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../hackathons.html">
                        Hackathons
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="03_practical_methods__data_on_manifolds.html">Data on Manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_practical_methods__from_vector_spaces_to_manifolds.html">From vector spaces to manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_practical_methods__simple_machine_learning_on_tangent_spaces.html">Learning on Tangent Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_practical_methods__riemannian_frechet_mean_and_tangent_pca.html">FrÃ©chet Mean and Tangent PCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_practical_methods__riemannian_kmeans.html">K-Means clustering on a Riemannian Manifold</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_practical_methods__information_geometry.html">Information geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_practical_methods__implement_your_own_riemannian_geometry.html">Implement your own Riemannian Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_practical_methods__shape_analysis.html">Shape analysis of curves with the Square Root Velocity metric</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Align all and Compute for Graphs</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="11_real_world_applications__cell_shapes_analysis.html">Shape Analysis of Cancer Cells</a></li>









<li class="toctree-l1"><a class="reference internal" href="12_real_world_applications__emg_sign_classification_in_spd_manifold.html">Hand gesture classification with EMG data using Riemannian metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_real_world_applications__graph_embedding_and_clustering_in_hyperbolic_space.html">Hyperbolic Embedding of Graphs and Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_real_world_applications__hand_poses_analysis_in_kendall_shape_space.html">Classifying hands poses with Kendall shape spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_real_world_applications__optic_nerve_heads_analysis_in_kendall_shape_space.html">Computing with shapes of landmarks in Kendall shape spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_real_world_applications__visualizations_in_kendall_shape_spaces.html">Computing with triangular shapes in Kendall framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_real_world_applications__sao_paulo_traffic_optimization.html">Optimization of Sao Paulo traffic</a></li>






<li class="toctree-l1"><a class="reference internal" href="20_real_world_applications__graph_space.html">Graph Space</a></li>


</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../tutorials/index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Align all...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="admonition note">
  <p>Notebook source code:
    <a class="reference external" href="https://github.com/geomstats/geomstats/blob/main/notebooks/19_practical_methods__aac.ipynb">notebooks/19_practical_methods__aac.ipynb</a>
    <br>Run it yourself on binder
    <a href="https://mybinder.org/v2/gh/geomstats/geomstats/main?filepath=notebooks/19_practical_methods__aac.ipynb"><img alt="Binder badge"
    src="https://mybinder.org/badge_logo.svg"
    style="vertical-align:text-bottom"></a>
  </p>
</div><section id="Align-all-and-Compute-for-Graphs">
<h1>Align all and Compute for Graphs<a class="headerlink" href="#Align-all-and-Compute-for-Graphs" title="Link to this heading">#</a></h1>
<p><span class="math notranslate nohighlight">\(\textbf{Lead Author: Anna Calissano}\)</span></p>
<p>Dear learner,</p>
<p>the aim of the current notebook is to introduce the align all and compute as a learning method for graphs. The align all and compute allows to estimate the Frechet Mean, the Generalized Geodesic Principal Components and the Regression. In this notebook you will learn how use all the learning methods.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>

<span class="kn">import</span> <span class="nn">geomstats.backend</span> <span class="k">as</span> <span class="nn">gs</span>

<span class="kn">from</span> <span class="nn">geomstats.geometry.symmetric_matrices</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">MatricesMetric</span> <span class="k">as</span> <span class="n">SymmetricMatricesMetric</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">geomstats.geometry.stratified.graph_space</span> <span class="kn">import</span> <span class="n">GraphSpace</span>
<span class="kn">from</span> <span class="nn">geomstats.learning.aac</span> <span class="kn">import</span> <span class="n">AAC</span>

<span class="n">gs</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: Using numpy backend
</pre></div></div>
</div>
<p>Letâ€™s start by creating simulated data using <code class="docutils literal notranslate"><span class="pre">networkx</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphset_1</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">erdos_renyi_graph</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">graphset_2</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">erdos_renyi_graph</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">graphset_3</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">erdos_renyi_graph</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">graphset_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_19_practical_methods__aac_4_0.png" src="../_images/notebooks_19_practical_methods__aac_4_0.png" />
</div>
</div>
<section id="A-primer-in-space,-metric-and-aligners">
<h2>A primer in space, metric and aligners<a class="headerlink" href="#A-primer-in-space,-metric-and-aligners" title="Link to this heading">#</a></h2>
<p>The first step is to create the embedding space. By default, it comes equipped with a metric.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span> <span class="o">=</span> <span class="n">GraphSpace</span><span class="p">(</span><span class="n">n_nodes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;geomstats.geometry.stratified.graph_space.GraphSpaceMetric at 0x7fbb7bec6210&gt;
</pre></div></div>
</div>
<p>By default, the space also comes with a total space (<code class="docutils literal notranslate"><span class="pre">Matrices</span></code>), which in turn comes equipped with a matrix (<code class="docutils literal notranslate"><span class="pre">MatricesMetric</span></code>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span><span class="o">.</span><span class="n">total_space</span><span class="o">.</span><span class="n">metric</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;geomstats.geometry.matrices.MatricesMetric at 0x7fbb7bb393d0&gt;
</pre></div></div>
</div>
<p>(<code class="docutils literal notranslate"><span class="pre">total_metric</span></code> can also be accessed from metric: <code class="docutils literal notranslate"><span class="pre">graph_space.metric.total_space_metric</span></code>.)</p>
<p>The default aligner is â€˜IDâ€™ (identity), which means the graphs are not permuted. To set â€˜FAQâ€™, do:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">set_aligner</span><span class="p">(</span><span class="s2">&quot;FAQ&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;geomstats.geometry.stratified.graph_space.FAQAligner at 0x7fbb7bb65510&gt;
</pre></div></div>
</div>
<p>With the FAQ alignment and the default Frobenious norm, we match two graphs and a set of graphs to a base graph:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_permuted</span> <span class="o">=</span> <span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">align_point_to_point</span><span class="p">(</span>
    <span class="n">base_graph</span><span class="o">=</span><span class="n">graphset_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">graph_to_permute</span><span class="o">=</span><span class="n">graphset_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">align_point_to_point</span><span class="p">(</span>
    <span class="n">base_graph</span><span class="o">=</span><span class="n">graphset_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">graph_to_permute</span><span class="o">=</span><span class="n">graphset_1</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[[0., 1., 1., 1., 1.],
        [0., 0., 1., 0., 1.],
        [0., 1., 0., 0., 0.],
        [0., 0., 1., 0., 0.],
        [0., 1., 0., 0., 0.]],

       [[0., 1., 0., 0., 1.],
        [0., 0., 0., 1., 1.],
        [0., 0., 0., 0., 1.],
        [0., 1., 1., 0., 0.],
        [1., 1., 1., 1., 0.]]])
</pre></div></div>
</div>
<p>To compute the distance we can either call the distance function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">graphset_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">graphset_1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.6457513110645907
</pre></div></div>
</div>
<p>Or, if the matching has been already run, we can use the identity matcher in the distance, to avoid computing the matching twice:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">set_aligner</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>

<span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">graphset_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">graph_permuted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.6457513110645907
</pre></div></div>
</div>
<p>Alternatively, use can use the total space metric instead.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">total_space_metric</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">graphset_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">graph_permuted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.6457513110645907
</pre></div></div>
</div>
<p>We can change the total space metric by doing:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span><span class="o">.</span><span class="n">total_space</span><span class="o">.</span><span class="n">equip_with_metric</span><span class="p">(</span><span class="n">SymmetricMatricesMetric</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;geomstats.geometry.matrices.Matrices at 0x7fbb7bcb2350&gt;
</pre></div></div>
</div>
<p>For the point to geodesic aligner, thereâ€™s no default set. In fact, if you try something like <code class="docutils literal notranslate"><span class="pre">graph_space.metric.align_point_to_geodesic(geodesic,</span> <span class="pre">point)</span></code>, a (hopefully) meaningful error will be raised, explaining how to set the point to geodesic aligner.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">set_point_to_geodesic_aligner</span><span class="p">(</span>
    <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">s_min</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">s_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;geomstats.geometry.stratified.graph_space.PointToGeodesicAligner at 0x7fbb7bd33ed0&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_point</span><span class="p">,</span> <span class="n">end_point</span> <span class="o">=</span> <span class="n">graph_space</span><span class="o">.</span><span class="n">random_point</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">geodesic_func</span> <span class="o">=</span> <span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">geodesic</span><span class="p">(</span><span class="n">init_point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">)</span>

<span class="n">aligned_init_point</span> <span class="o">=</span> <span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">align_point_to_geodesic</span><span class="p">(</span>
    <span class="n">geodesic_func</span><span class="p">,</span> <span class="n">init_point</span>
<span class="p">)</span>

<span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">total_space_metric</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">init_point</span><span class="p">,</span> <span class="n">aligned_init_point</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.0
</pre></div></div>
</div>
<p>This short introduction should be enough to set you up for experimenting with the learning algorithms on graphs.</p>
</section>
<section id="Frechet-Mean">
<h2>Frechet Mean<a class="headerlink" href="#Frechet-Mean" title="Link to this heading">#</a></h2>
<p>Reference: Calissano, A., Feragen, A., &amp; Vantini, S. (2020). Populations of unlabeled networks: Graph space geometry and geodesic principal components. MOX Report.</p>
<p>Given <span class="math notranslate nohighlight">\(\{[X_1], \dots, [X_k]\}, [x_i] \in X/T\)</span>, we estimate the Frechet Mean using AAC consisting on two steps: 1. Compute <span class="math notranslate nohighlight">\(\hat{X}\)</span> as arithmetic mean of <span class="math notranslate nohighlight">\(\{X_1, \dots, X_k\}, X_i \in X\)</span> 2. Using graph to graph alignment to find <span class="math notranslate nohighlight">\(\{X_1, \dots, X_k\}, X_i \in X\)</span> optimally aligned with <span class="math notranslate nohighlight">\(\hat{X}\)</span></p>
<p>Letâ€™s instantiate the graph space and set the aligner.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span> <span class="o">=</span> <span class="n">GraphSpace</span><span class="p">(</span><span class="n">n_nodes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">set_aligner</span><span class="p">(</span><span class="s2">&quot;FAQ&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;geomstats.geometry.stratified.graph_space.FAQAligner at 0x7fbb7bb857d0&gt;
</pre></div></div>
</div>
<p>And now create the estimator, and fit the data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aac_fm</span> <span class="o">=</span> <span class="n">AAC</span><span class="p">(</span><span class="n">estimate</span><span class="o">=</span><span class="s2">&quot;frechet_mean&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="p">)</span>

<span class="n">fm</span> <span class="o">=</span> <span class="n">aac_fm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">graphset_2</span><span class="p">)</span>

<span class="n">fm</span><span class="o">.</span><span class="n">estimate_</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: Maximum number of iterations 20 reached. The estimate may be inaccurate
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.  , 0.82, 0.81, 0.4 , 0.34],
       [0.95, 0.  , 0.87, 0.59, 0.79],
       [0.51, 0.4 , 0.  , 0.28, 0.16],
       [0.88, 0.81, 0.73, 0.  , 0.6 ],
       [0.61, 0.46, 0.7 , 0.07, 0.  ]])
</pre></div></div>
</div>
</section>
<section id="Principal-Components">
<h2>Principal Components<a class="headerlink" href="#Principal-Components" title="Link to this heading">#</a></h2>
<p>Reference: Calissano, A., Feragen, A., &amp; Vantini, S. (2020). Populations of unlabeled networks: Graph space geometry and geodesic principal components. MOX Report.</p>
<p>We estimate the Generalized Geodesics Principal Components Analysis (GGPCA) using AAC. Given ${[X_1], <span class="math">\dots</span>, [X_k]}, (s_i,[X_i]) :nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>in <a href="#id3"><span class="problematic" id="id4">`</span></a>X/T $ we are searching for:</p>
<div class="math notranslate nohighlight">
\[\gamma: \mathbb{R}\rightarrow X/T\]</div>
<p>generalized geodesic principal component capturing the majority of the variability of the dataset. The AAC for ggpca works in two steps:</p>
<ol class="arabic simple">
<li><p>finding <span class="math notranslate nohighlight">\(\delta: \mathbb{R}\rightarrow X\)</span> principal component in the set of adjecency matrices <span class="math notranslate nohighlight">\(\{X_1, \dots, X_k\}, X_i \in X\)</span></p></li>
<li><p>finding <span class="math notranslate nohighlight">\(\{X_1, \dots, X_k\}, X_i \in X\)</span> as optimally aligned with respect to <span class="math notranslate nohighlight">\(\gamma\)</span>. The estimation required a point to geodesic aligment defined in the metric.</p></li>
</ol>
<p>As before:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span> <span class="o">=</span> <span class="n">GraphSpace</span><span class="p">(</span><span class="n">n_nodes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">set_aligner</span><span class="p">(</span><span class="s2">&quot;FAQ&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;geomstats.geometry.stratified.graph_space.FAQAligner at 0x7fbb7bb67990&gt;
</pre></div></div>
</div>
<p>For GGPCA, we also need to set the pont to geodesic aligner.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">set_point_to_geodesic_aligner</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">s_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s_max</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;geomstats.geometry.stratified.graph_space.PointToGeodesicAligner at 0x7fbb7bb94410&gt;
</pre></div></div>
</div>
<p>Again, create the estimator and fit the data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aac_ggpca</span> <span class="o">=</span> <span class="n">AAC</span><span class="p">(</span><span class="n">estimate</span><span class="o">=</span><span class="s2">&quot;ggpca&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">aac_ggpca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">graphset_3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<section id="Regression">
<h3>Regression<a class="headerlink" href="#Regression" title="Link to this heading">#</a></h3>
<p>Reference: Calissano, A., Feragen, A., &amp; Vantini, S. (2022). Graph-valued regression: Prediction of unlabelled networks in a non-Euclidean graph space. Journal of Multivariate Analysis, 190, 104950.</p>
<p>We estimate a graph-to-value regression model to predict graph from scalar or vectors. Given ${(s_1,[X_1]), <span class="math">\dots</span>, (s_k, [X_k])}, (s_i,[X_i]) <span class="math">\in `:nbsphinx-math:</span>mathbb{R}`^p:nbsphinx-math:<a href="#id5"><span class="problematic" id="id6">`</span></a>times <a href="#id7"><span class="problematic" id="id8">`</span></a>X/T $ we are searching for:</p>
<div class="math notranslate nohighlight">
\[f: \mathbb{R}^p\rightarrow X/T\]</div>
<p>where <span class="math notranslate nohighlight">\(f\in \mathcal{F}(X/T)\)</span> is a generalized geodesic regression model, i.e., the canonical projection onto Graph Space of a regression line <span class="math notranslate nohighlight">\(h_\beta : \mathbb{R}^p\rightarrow X\)</span> of the form</p>
<div class="math notranslate nohighlight">
\[h_\beta(s) = \sum_{j=1}^{p} \beta_i s_i\]</div>
<p>The AAC algorithm for regression combines the estimation of <span class="math notranslate nohighlight">\(h_\beta\)</span> given <span class="math notranslate nohighlight">\(\{X_1, \dots, X_k\}, X_i \in X\)</span></p>
<div class="math notranslate nohighlight">
\[\sum_{i=0}^{k} d_X(h_\beta(s_i), X_i)\]</div>
<p>and the searching for <span class="math notranslate nohighlight">\(\{X_1, \dots, X_k\}, X_i \in X\)</span> optimally aligned with respect to the prediction along the current regression model:</p>
<div class="math notranslate nohighlight">
\[\min_{t\in T}d_X(h_\beta(s_i),t^TX_it)\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_space</span> <span class="o">=</span> <span class="n">GraphSpace</span><span class="p">(</span><span class="n">n_nodes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">set_aligner</span><span class="p">(</span><span class="s2">&quot;FAQ&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;geomstats.geometry.stratified.graph_space.FAQAligner at 0x7fbb7bea1ed0&gt;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aac_reg</span> <span class="o">=</span> <span class="n">AAC</span><span class="p">(</span><span class="n">estimate</span><span class="o">=</span><span class="s2">&quot;regression&quot;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aac_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">graphset_1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<p>The coefficients are saved in the following attributes and they can be changed into a graph shape.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aac_reg</span><span class="o">.</span><span class="n">total_space_estimator</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[-0.        ],
       [-0.09958506],
       [-0.05394191],
       [ 0.02904564],
       [-0.06639004],
       [-0.02904564],
       [-0.        ],
       [ 0.05394191],
       [ 0.01659751],
       [-0.04564315],
       [-0.        ],
       [ 0.0373444 ],
       [-0.        ],
       [-0.03319502],
       [ 0.0746888 ],
       [ 0.09543568],
       [ 0.02489627],
       [ 0.00829876],
       [-0.        ],
       [-0.11618257],
       [-0.0746888 ],
       [ 0.09128631],
       [ 0.10373444],
       [ 0.04979253],
       [-0.        ]])
</pre></div></div>
</div>
<p>A graph can be predicted using the fit model and the corresponding prediction error can be computed:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph_pred</span> <span class="o">=</span> <span class="n">aac_reg</span><span class="o">.</span><span class="n">total_space_estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="n">gs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">graph_space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">graphset_1</span><span class="p">,</span> <span class="n">graph_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
16.511901318893987
</pre></div></div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="10_practical_methods__shape_analysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Shape analysis of curves with the Square Root Velocity metric</p>
      </div>
    </a>
    <a class="right-next"
       href="11_real_world_applications__cell_shapes_analysis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Shape Analysis of Cancer Cells</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#A-primer-in-space,-metric-and-aligners">A primer in space, metric and aligners</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Frechet-Mean">Frechet Mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Principal-Components">Principal Components</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Regression">Regression</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/notebooks/19_practical_methods__aac.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright 2022-2023, Geomstats, Inc..
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>