<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial : Computing with triangular shapes in Kendall framework &mdash; Geomstats latest documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
    <link rel="canonical" href="geomstats.github.io/notebooks/usecase_visualizations_in_kendall_shape_spaces.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Tutorial: Classifying hands poses with Kendall shape spaces" href="usecase_hand_poses_analysis_in_kendall_shape_space.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Geomstats
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../first-steps.html">First steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01_data_on_manifolds.html">Tutorial: Data on Manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_from_vector_spaces_to_manifolds.html">Tutorial: From vector spaces to manifolds</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_simple_machine_learning_on_tangent_spaces.html">Tutorial: Learning on Tangent Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_riemannian_frechet_mean_and_tangent_pca.html">Tutorial: Fréchet Mean and Tangent PCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_riemannian_kmeans.html">Tutorial: K-Means clustering on a Riemannian Manifold</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_information_geometry.html">Tutorial: Information geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_implement_your_own_riemannian_geometry.html">Tutorial: Implement your own Riemannian Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_shape_analysis.html">Shape analysis of curves with the Square Root Velocity metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="usecase_emg_sign_classification_in_spd_manifold.html">Tutorial: Hand gesture classification with EMG data using Riemannian metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="usecase_graph_embedding_and_clustering_in_hyperbolic_space.html">Tutorial: Hyperbolic Embedding of Graphs and Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="usecase_optic_nerve_heads_analysis_in_kendall_shape_space.html">Tutorial: Computing with shapes of landmarks in Kendall shape spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="usecase_hand_poses_analysis_in_kendall_shape_space.html">Tutorial: Classifying hands poses with Kendall shape spaces</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial : Computing with triangular shapes in Kendall framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Set-up">Set up</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-space-\Sigma_2^3-of-2D-triangles">The space <span class="math notranslate nohighlight">\(\Sigma_2^3\)</span> of 2D triangles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Uniform-distribution">Uniform distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Geodesic">Geodesic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Parallel-transport">Parallel transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-space-\Sigma_3^3-of-3D-triangles">The space <span class="math notranslate nohighlight">\(\Sigma_3^3\)</span> of 3D triangles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Uniform distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Geodesics">Geodesics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">Parallel transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Usecase-:-optical-nerve-heads">Usecase : optical nerve heads</a></li>
<li class="toctree-l2"><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Geomstats</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tutorial : Computing with triangular shapes in Kendall framework</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/usecase_visualizations_in_kendall_shape_spaces.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
  <p>Notebook source code:
    <a class="reference external" href="https://github.com/geomstats/geomstats/blob/master/notebooks/usecase_visualizations_in_kendall_shape_spaces.ipynb">notebooks/usecase_visualizations_in_kendall_shape_spaces.ipynb</a>
    <br>Run it yourself on binder
    <a href="https://mybinder.org/v2/gh/geomstats/geomstats/master?filepath=notebooks/usecase_visualizations_in_kendall_shape_spaces.ipynb"><img alt="Binder badge"
    src="https://mybinder.org/badge_logo.svg"
    style="vertical-align:text-bottom"></a>
  </p>
</div><div class="section" id="Tutorial-:-Computing-with-triangular-shapes-in-Kendall-framework">
<h1>Tutorial : Computing with triangular shapes in Kendall framework<a class="headerlink" href="#Tutorial-:-Computing-with-triangular-shapes-in-Kendall-framework" title="Permalink to this headline"></a></h1>
<p>Lead author: Elodie Maignant.</p>
<p>David G. Kendall first took interest into triangular shapes while studying random alignments of points in archeology and related fields <a class="reference external" href="#References">[KK1980]</a>. Following this statistical study, he developped the more general theory of shapes. This theory echoes in many fields like biology, medicine, or image analysis, where the shape of an object is particularly relevant when it comes to its analysis. Since the deformation of a shape is not necessarely linear, we need to use geometric
statistics in order to proceed with such data.</p>
<p>In Kendall theory, the word shape is used in the common sense, refering to the appearance of an object. Since the shape of an object should not depend on the way it is looked at or computed, it is natural to remove location, rotationnal and eventually scale effects. A practical way of describing an object’s shape is to locate a finite number of relevant points on it, which we call landmarks, which should summarize the geometrical and/or scientifical information <a class="reference external" href="#References">[DM2016]</a>.</p>
<p>Thus we define Kendall shape space of order <span class="math notranslate nohighlight">\((k,m)\)</span> (where <span class="math notranslate nohighlight">\(k\geq 2\)</span>) as the quotient of <span class="math notranslate nohighlight">\(k\)</span>-tuples of non-aligned points in <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> by the group of rotations, translations and dilatations of <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> :</p>
<div class="math notranslate nohighlight">
\[\big(\Sigma^k_m\triangleq\mathbb{R}^{km}\setminus \Delta \big)/\big(\mathbb{R_+^*}\times SO(m)\ltimes \mathbb{R}^m\big)\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta =\{\ (a)_{1\leq i\leq k}\ |\ a\in\mathbb{R}^m\}\)</span> correspond to the degenerate case where all landmarks collapse into a unique point.</p>
<p>It is useful to see that considering first the action of translations and dilatations before applying rotation group <span class="math notranslate nohighlight">\(\text{SO}\)</span> allows to write :</p>
<div class="math notranslate nohighlight">
\[\Sigma^k_m=\mathcal{S}^k_m/ \text{SO}(m)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{S}^k_m\)</span>, called the pre-shape space of order <span class="math notranslate nohighlight">\((k,m)\)</span> denotes the space of centered and normalized <span class="math notranslate nohighlight">\(k\)</span>-tuples of in <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span>. It corresponds to the unit sphere of dimension <span class="math notranslate nohighlight">\(k(m-1)\)</span> <a class="reference external" href="#References">[K1984]</a>.</p>
<p>The Kendall shape space of order <span class="math notranslate nohighlight">\((k,m)\)</span> is a differential manifold which acquires singularities as soon as <span class="math notranslate nohighlight">\(m\geq 3\)</span>. Apart from these singularities, it is a smooth manifold which can be equipped with a Riemannian metric inherited from the Frobenius metric on the pre-shape space <a class="reference external" href="#References">[LK1993]</a>.</p>
<p>In this tutorial, we take a deeper look at two specific cases of Kendall shape spaces : the space <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span> of 2D triangles and the space <span class="math notranslate nohighlight">\(\Sigma^3_3\)</span> of 3D triangles. These two spaces are particularly interesting to look at because there exists a projection such that we can directly visualize them.</p>
<p>The tutorial is organized as follows :</p>
<ul class="simple">
<li><p>First, we present the case of 2D triangles, and illustrate some geometric tools with a dedicated visualization class.</p></li>
<li><p>Then, following the same scheme, we look at the 3D case.</p></li>
<li><p>Finally, we explore these visualizations with the dataset of the optical nerves head</p></li>
</ul>
<div class="section" id="Set-up">
<h2>Set up<a class="headerlink" href="#Set-up" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="kn">import</span> <span class="nn">geomstats.backend</span> <span class="k">as</span> <span class="nn">gs</span>
<span class="kn">import</span> <span class="nn">geomstats.datasets.utils</span> <span class="k">as</span> <span class="nn">data_utils</span>
<span class="kn">from</span> <span class="nn">geomstats.geometry.pre_shape</span> <span class="kn">import</span> <span class="n">KendallShapeMetric</span><span class="p">,</span> <span class="n">PreShapeSpace</span>
<span class="kn">from</span> <span class="nn">geomstats.visualization</span> <span class="kn">import</span> <span class="n">KendallDisk</span><span class="p">,</span> <span class="n">KendallSphere</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: Using numpy backend
</pre></div></div>
</div>
</div>
<div class="section" id="The-space-\Sigma_2^3-of-2D-triangles">
<h2>The space <span class="math notranslate nohighlight">\(\Sigma_2^3\)</span> of 2D triangles<a class="headerlink" href="#The-space-\Sigma_2^3-of-2D-triangles" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m_ambient</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">k_landmarks</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">preshape_triangle_2d</span> <span class="o">=</span> <span class="n">PreShapeSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">metric_triangle_2d</span> <span class="o">=</span> <span class="n">KendallShapeMetric</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The space <span class="math notranslate nohighlight">\(\Sigma_2^3\)</span> of 2D triangles is a manifold of dimension <span class="math notranslate nohighlight">\(2=3\times(2-1)-1\)</span>. Kendall showed that it is isometric to the <span class="math notranslate nohighlight">\(2\)</span>-sphere of radius <span class="math notranslate nohighlight">\(1/2\)</span> <a class="reference external" href="#References">[K1984]</a>. Such an isometry can be computed explicitly. Practically, this means that 2D triangular shape datasets can be directly visualized in 3D without losing any information (especially geometrical ones). Furthermore, all geometric statistics can be directly processed on the sphere, for which we
already have a large catalogue of explicit methods.</p>
<p>First step consist in projecting (via the isometry mentionned above) the triangles on the sphere. In order to visualize better how the space <span class="math notranslate nohighlight">\(\Sigma_2^3\)</span> is mapped onto the sphere <span class="math notranslate nohighlight">\(S^2(1/2)\)</span>, we plot regularly sampled triangles at their corresponding location (according to the projection).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">KendallSphere</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">S</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_11_0.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_11_0.png" />
</div>
</div>
<p>One can easily notice that the equator corresponds to flat triangles while first meridian is paired with the subset of isocele triangles whose apex is red.</p>
<p>We now illustrate how some essential statistic and geometric tools project on the sphere.</p>
</div>
<div class="section" id="Uniform-distribution">
<h2>Uniform distribution<a class="headerlink" href="#Uniform-distribution" title="Permalink to this headline"></a></h2>
<p>Since the projection is isometric, the uniform distribution in <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span> is exactly the uniform distribution on the sphere.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">S</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">preshape_triangle_2d</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">S</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_16_0.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_16_0.png" />
</div>
</div>
</div>
<div class="section" id="Geodesic">
<h2>Geodesic<a class="headerlink" href="#Geodesic" title="Permalink to this headline"></a></h2>
<p>The geodesics in <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span> corresponds to great circles on the sphere. The distance between two triangles of <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span> is given exactly by the arc-length of the arc joining the two projected points on the sphere. The diameter of the space <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span>, defined as the distance between the two most distant points, is then equal to <span class="math notranslate nohighlight">\(\pi/2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">S</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">velocities</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">t</span> <span class="o">*</span> <span class="mf">.5</span> <span class="o">*</span> <span class="n">S</span><span class="o">.</span><span class="n">ub</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">])</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">metric_triangle_2d</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">velocities</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">pole</span><span class="p">)</span>

<span class="n">S</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">draw_curve</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">points</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">S</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_19_0.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_19_0.png" />
</div>
</div>
</div>
<div class="section" id="Parallel-transport">
<h2>Parallel transport<a class="headerlink" href="#Parallel-transport" title="Permalink to this headline"></a></h2>
<p>Given the geodesics and the logarithm map, one can easily compute the parallel transport of a vector <span class="math notranslate nohighlight">\(w\)</span> along the geodesic <span class="math notranslate nohighlight">\(\exp_\text{b.p.}(tv)\)</span> using the Pole Ladder algorithm implemented in geomstats.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_point</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">pole</span><span class="p">,</span> <span class="o">-</span><span class="mf">.5</span> <span class="o">*</span> <span class="n">S</span><span class="o">.</span><span class="n">ub</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">ua</span>
<span class="n">n_rungs</span><span class="o">=</span><span class="mi">10</span>
<span class="n">ladder</span> <span class="o">=</span> <span class="n">metric_triangle_2d</span><span class="o">.</span><span class="n">ladder_parallel_transport</span><span class="p">(</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">base_point</span><span class="p">,</span> <span class="n">n_rungs</span><span class="p">,</span> <span class="n">return_geodesics</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">transported</span> <span class="o">=</span> <span class="n">ladder</span><span class="p">[</span><span class="s1">&#39;transported_tangent_vec&#39;</span><span class="p">]</span>
<span class="n">end_point</span> <span class="o">=</span> <span class="n">ladder</span><span class="p">[</span><span class="s1">&#39;end_point&#39;</span><span class="p">]</span>
<span class="n">trajectory</span> <span class="o">=</span> <span class="n">ladder</span><span class="p">[</span><span class="s1">&#39;trajectory&#39;</span><span class="p">]</span>

<span class="n">n_points</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
<span class="n">t_main</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">main</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">diag</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">trajectory</span><span class="p">:</span>
    <span class="n">main_geodesic</span><span class="p">,</span> <span class="n">diagonal</span><span class="p">,</span> <span class="n">final_geodesic</span> <span class="o">=</span> <span class="n">points</span>
    <span class="n">main</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">main_geodesic</span><span class="p">(</span><span class="n">t_main</span><span class="p">))</span>
    <span class="n">diag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diagonal</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">))</span>
    <span class="n">diag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diagonal</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="n">diag</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_landmarks</span><span class="p">,</span> <span class="n">m_ambient</span><span class="p">)</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_landmarks</span><span class="p">,</span> <span class="n">m_ambient</span><span class="p">)</span>

<span class="n">tangent_vectors</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">/</span> <span class="n">n_rungs</span><span class="p">,</span> <span class="n">w</span> <span class="o">/</span> <span class="n">n_rungs</span><span class="p">,</span> <span class="n">transported</span> <span class="o">/</span> <span class="n">n_rungs</span><span class="p">]</span>
<span class="n">base_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">base_point</span><span class="p">,</span> <span class="n">base_point</span><span class="p">,</span> <span class="n">main</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">S</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">S</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">draw_curve</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">bp</span><span class="p">,</span> <span class="n">tv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">base_points</span><span class="p">,</span> <span class="n">tangent_vectors</span><span class="p">):</span>
    <span class="n">S</span><span class="o">.</span><span class="n">draw_vector</span><span class="p">(</span><span class="n">tv</span><span class="p">,</span> <span class="n">bp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_23_0.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_23_0.png" />
</div>
</div>
<p>The diagonal geodesics used by the Pole Ladder method to compute the parallel transport are plotted in red.</p>
<p>In the specific case of Kendall shape spaces, one can use a second method, based on an integration scheme. This method follows the result of <a class="reference external" href="#References">[KDLS2021]</a> giving conditions on a vector field in the top space <span class="math notranslate nohighlight">\(\mathcal S^k_m\)</span> for its projection to be the parallel transport in the shape space <span class="math notranslate nohighlight">\(\Sigma^k_m\)</span>. The implementation of the method can be found in the
<a class="reference external" href="https://github.com/geomstats/geomstats/blob/f9f669551faeaf8c23f347b57d1ce3970eacbe3a/geomstats/geometry/pre_shape.py#L569">KendallShapeMetric</a> and is described along with its comparison to the Pole Ladder method in <a class="reference external" href="#References">[GMTP21]</a>.</p>
</div>
<div class="section" id="The-space-\Sigma_3^3-of-3D-triangles">
<h2>The space <span class="math notranslate nohighlight">\(\Sigma_3^3\)</span> of 3D triangles<a class="headerlink" href="#The-space-\Sigma_3^3-of-3D-triangles" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m_ambient</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">k_landmarks</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">preshape_triangle_3d</span> <span class="o">=</span> <span class="n">PreShapeSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">metric_triangle_3d</span> <span class="o">=</span> <span class="n">KendallShapeMetric</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Once we know that <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span> is isometric to the <span class="math notranslate nohighlight">\(2\)</span>-shere of radius <span class="math notranslate nohighlight">\(1/2\)</span>, it follows that the space <span class="math notranslate nohighlight">\(\Sigma_3^3\)</span> of 3D triangles is then isometric to the <span class="math notranslate nohighlight">\(1\)</span>-ball of radius <span class="math notranslate nohighlight">\(\pi/4\)</span>. More generally, for <span class="math notranslate nohighlight">\(m\geq k\)</span>, the space <span class="math notranslate nohighlight">\(\Sigma^k_m\)</span> is isometric to the quotient <span class="math notranslate nohighlight">\(\Sigma^k_{k-1}/\mathbb{Z}_2\)</span> <a class="reference external" href="#References">[LK1993]</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">KendallDisk</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_30_0.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_30_0.png" />
</div>
</div>
<p>The shape space <span class="math notranslate nohighlight">\(\Sigma_3^3\)</span> is a manifold with boundary, which coincides with its singularity. We see on the above figure that it corresponds to set of flat triangles, which was located on the equator in the case of <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flat</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                 <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span><span class="o">/</span><span class="n">gs</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span>

<span class="n">preshape_triangle_3d</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">flat</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">centre</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: Singularity close, ill-conditioned matrix encountered: 0.0
WARNING: Alignment matrix is not unique.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[ 0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [ 8.89809642e-18,  7.07106781e-01,  0.00000000e+00],
       [-8.89809642e-18, -7.07106781e-01,  0.00000000e+00]])
</pre></div></div>
</div>
</div>
<div class="section" id="id1">
<h2>Uniform distribution<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h2>
<p>As in the previous example, the uniform distribution on <span class="math notranslate nohighlight">\(\Sigma^3_3\)</span> is given exactly by the uniform distribution on a disk.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">preshape_triangle_3d</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_35_0.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_35_0.png" />
</div>
</div>
</div>
<div class="section" id="Geodesics">
<h2>Geodesics<a class="headerlink" href="#Geodesics" title="Permalink to this headline"></a></h2>
<p>We show a first example where the geodesic is radial. It is the projection of the geodesic we previously shot in <span class="math notranslate nohighlight">\(\Sigma^3_2\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ub_3d</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">D</span><span class="o">.</span><span class="n">ub</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">D</span><span class="o">.</span><span class="n">ub</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">gs</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">))))</span>
<span class="n">speeds</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">t</span> <span class="o">*</span> <span class="mf">.5</span> <span class="o">*</span> <span class="n">ub_3d</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">])</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">metric_triangle_3d</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">speeds</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">centre</span><span class="p">)</span>

<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_curve</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">points</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_38_0.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_38_0.png" />
</div>
</div>
<p>We show a second example where the initial point is no more the equilateral triangle.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">base_point</span> <span class="o">=</span> <span class="n">preshape_triangle_3d</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">centre</span> <span class="o">+</span> <span class="mf">.35</span> <span class="o">*</span> <span class="n">ub_3d</span><span class="p">)</span>
<span class="n">tangent_vec</span> <span class="o">=</span> <span class="n">preshape_triangle_3d</span><span class="o">.</span><span class="n">to_tangent</span><span class="p">(</span><span class="n">preshape_triangle_3d</span><span class="o">.</span><span class="n">random_point</span><span class="p">(),</span> <span class="n">base_point</span><span class="p">)</span>
<span class="n">tangent_vec</span> <span class="o">=</span> <span class="mf">.5</span> <span class="o">*</span> <span class="n">tangent_vec</span> <span class="o">/</span> <span class="n">metric_triangle_3d</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">tangent_vec</span><span class="p">,</span> <span class="n">base_point</span><span class="p">)</span>
<span class="n">speeds</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t</span> <span class="o">*</span> <span class="n">tangent_vec</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">])</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">metric_triangle_3d</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">speeds</span><span class="p">,</span> <span class="n">base_point</span><span class="p">)</span>

<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_curve</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">points</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_40_0.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_40_0.png" />
</div>
</div>
</div>
<div class="section" id="id2">
<h2>Parallel transport<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h2>
<p>We compute the parallel transport of an orthogonal vector <span class="math notranslate nohighlight">\(w\)</span> along the previous geodesic using the Pole Ladder method.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_point</span> <span class="o">=</span> <span class="n">base_point</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">tangent_vec</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">preshape_triangle_3d</span><span class="o">.</span><span class="n">to_tangent</span><span class="p">(</span><span class="n">preshape_triangle_3d</span><span class="o">.</span><span class="n">random_point</span><span class="p">(),</span> <span class="n">base_point</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">metric_triangle_3d</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">tangent_vec</span><span class="p">,</span> <span class="n">base_point</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">tangent_vec</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">/</span> <span class="n">metric_triangle_3d</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">base_point</span><span class="p">)</span>
<span class="n">n_rungs</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">ladder</span> <span class="o">=</span> <span class="n">metric_triangle_3d</span><span class="o">.</span><span class="n">ladder_parallel_transport</span><span class="p">(</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">base_point</span><span class="p">,</span> <span class="n">n_rungs</span><span class="p">,</span> <span class="n">return_geodesics</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">transported</span> <span class="o">=</span> <span class="n">ladder</span><span class="p">[</span><span class="s1">&#39;transported_tangent_vec&#39;</span><span class="p">]</span>
<span class="n">end_point</span> <span class="o">=</span> <span class="n">ladder</span><span class="p">[</span><span class="s1">&#39;end_point&#39;</span><span class="p">]</span>
<span class="n">trajectory</span> <span class="o">=</span> <span class="n">ladder</span><span class="p">[</span><span class="s1">&#39;trajectory&#39;</span><span class="p">]</span>

<span class="n">n_points</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
<span class="n">t_main</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">n_points</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">main</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">diag</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">points</span> <span class="ow">in</span> <span class="n">trajectory</span><span class="p">:</span>
    <span class="n">main_geodesic</span><span class="p">,</span> <span class="n">diagonal</span><span class="p">,</span> <span class="n">final_geodesic</span> <span class="o">=</span> <span class="n">points</span>
    <span class="n">main</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">main_geodesic</span><span class="p">(</span><span class="n">t_main</span><span class="p">))</span>
    <span class="n">diag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diagonal</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">))</span>
    <span class="n">diag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diagonal</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="n">diag</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_landmarks</span><span class="p">,</span> <span class="n">m_ambient</span><span class="p">)</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">k_landmarks</span><span class="p">,</span> <span class="n">m_ambient</span><span class="p">)</span>

<span class="n">tangent_vectors</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">/</span> <span class="n">n_rungs</span><span class="p">,</span> <span class="n">w</span> <span class="o">/</span> <span class="n">n_rungs</span><span class="p">,</span> <span class="n">transported</span> <span class="o">/</span> <span class="n">n_rungs</span><span class="p">]</span>
<span class="n">base_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">base_point</span><span class="p">,</span> <span class="n">base_point</span><span class="p">,</span> <span class="n">main</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_curve</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">diag</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">bp</span><span class="p">,</span> <span class="n">vec</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">base_points</span><span class="p">,</span> <span class="n">tangent_vectors</span><span class="p">):</span>
    <span class="n">D</span><span class="o">.</span><span class="n">draw_vector</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">bp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mf">.003</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_44_0.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_44_0.png" />
</div>
</div>
</div>
<div class="section" id="Usecase-:-optical-nerve-heads">
<h2>Usecase : optical nerve heads<a class="headerlink" href="#Usecase-:-optical-nerve-heads" title="Permalink to this headline"></a></h2>
<p>In this usecase, we will illustrate how to use this last visualization class while investigating if there is a difference between two groups :</p>
<ul class="simple">
<li><p>optical nerve heads that correspond to normal eyes,</p></li>
<li><p>optical nerve heads that correspond to glaucoma eyes.</p></li>
</ul>
<p>We import the dataset of the optical nerve heads from 22 images of Rhesus monkeys’ eyes (11 monkeys), available in [PE2015].</p>
<p>For each monkey, an experimental glaucoma was introduced in one eye, while the second eye was kept as control. One seeks to observe differences between the glaucoma and the control eyes. On each image, 5 anatomical landmarks were recorded:</p>
<ul class="simple">
<li><p>1st landmark: superior aspect of the retina,</p></li>
<li><p>2nd landmark: side of the retina closest to the temporal bone of the skull,</p></li>
<li><p>3rd landmark: nose side of the retina,</p></li>
<li><p>4th landmark: inferior point,</p></li>
<li><p>5th landmark: optical nerve head deepest point.</p></li>
</ul>
<p>Label 0 refers to a normal eye, and Label 1 to an eye with glaucoma.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nerves</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">monkeys</span> <span class="o">=</span> <span class="n">data_utils</span><span class="o">.</span><span class="n">load_optical_nerves</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nerves</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">monkeys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(22, 5, 3)
[0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1]
[ 0  0  1  1  2  2  3  3  4  4  5  5  6  6  7  7  8  8  9  9 10 10]
</pre></div></div>
</div>
<p>For this study we will consider only 3 first landmarks, such that our dataset is now a set of 22 labeled triangles.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">landmarks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">nerves</span><span class="p">[:,</span> <span class="n">landmarks</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<p>We can visualize the dataset on the disk.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">KendallDisk</span><span class="p">(</span><span class="n">point_type</span><span class="o">=</span><span class="s1">&#39;extrinsic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normal_points</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">glaucoma_points</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">normal_points</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normal eyes&#39;</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">glaucoma</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">glaucoma_points</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Glaucoma eyes&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7fe2c1c7a550&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_52_1.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_52_1.png" />
</div>
</div>
<p>We observe that the two sets are very compact and well superimposed. It means that this choice of 3 landmarks isn’t of any help in separating the two groups. Therfore, we choose to include the 5th landmark into the selection and run a new example.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">landmarks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">nerves</span><span class="p">[:,</span> <span class="n">landmarks</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normal_points</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">glaucoma_points</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="k">if</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">normal_points</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normal eyes&#39;</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">glaucoma</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">glaucoma_points</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Glaucoma eyes&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7fe2c8081650&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_55_1.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_55_1.png" />
</div>
</div>
<p>In this example, we observe a bigger variability within the two groups. Even though we can’t separate them visually, they are not superimposed either. To highlight this, we can compute the Frechet mean of each group.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geomstats.learning.frechet_mean</span> <span class="kn">import</span> <span class="n">FrechetMean</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FM</span> <span class="o">=</span> <span class="n">FrechetMean</span><span class="p">(</span><span class="n">metric_triangle_3d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normal_mean</span> <span class="o">=</span> <span class="n">FM</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">preshape_triangle_3d</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">normal_points</span><span class="p">))</span><span class="o">.</span><span class="n">estimate_</span>
<span class="n">glaucoma_mean</span> <span class="o">=</span> <span class="n">FM</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">preshape_triangle_3d</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span><span class="n">glaucoma_points</span><span class="p">))</span><span class="o">.</span><span class="n">estimate_</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> In [36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">normal_points</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normal eyes&#39;</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">glaucoma</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">glaucoma_points</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Glaucoma eyes&#39;</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">normal_mean</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean of normal eyes&#39;</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">clear_points</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">add_points</span><span class="p">(</span><span class="n">glaucoma_mean</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">draw_points</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean of glaucoma eyes&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;xx-large&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span> Out [36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7fe2c287dd50&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_60_1.png" src="../_images/notebooks_usecase_visualizations_in_kendall_shape_spaces_60_1.png" />
</div>
</div>
<p>We observe that the two means are slightly different.</p>
</div>
<div class="section" id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this headline"></a></h2>
<dl class="citation">
<dt class="label" id="kk1980"><span class="brackets">KK1980</span></dt>
<dd><p>KENDALL, David G. et KENDALL, Wilfrid S. Alignments in two-dimensional random sets of points. Advances in Applied probability, 1980, p. 380-424. <a class="reference external" href="https://doi.org/10.2307/1426603">https://doi.org/10.2307/1426603</a></p>
</dd>
<dt class="label" id="dm2016"><span class="brackets">DM2016</span></dt>
<dd><p>DRYDEN, Ian L. et MARDIA, Kanti V. Statistical shape analysis: with applications in R. John Wiley &amp; Sons, 2016. <a class="reference external" href="https://doi.org/10.1002/9781119072492">https://doi.org/10.1002/9781119072492</a></p>
</dd>
<dt class="label" id="k1984"><span class="brackets">K1984</span></dt>
<dd><p>KENDALL, David G. Shape manifolds, procrustean metrics, and complex projective spaces. Bulletin of the London mathematical society, 1984, vol. 16, no 2, p. 81-121. <a class="reference external" href="https://doi.org/10.1112/blms/16.2.81">https://doi.org/10.1112/blms/16.2.81</a></p>
</dd>
<dt class="label" id="lk1993"><span class="brackets">LK1993</span></dt>
<dd><p>LE, Huiling, KENDALL, David G., et al. The Riemannian structure of Euclidean shape spaces: a novel environment for statistics. Annals of statistics, 1993, vol. 21, no 3, p. 1225-1271. <a class="reference external" href="https://doi.org/10.1112/blms/16.2.81">https://doi.org/10.1112/blms/16.2.81</a></p>
</dd>
<dt class="label" id="kdls2021"><span class="brackets">KDLS2021</span></dt>
<dd><p>KIM, Kwang-Rae, DRYDEN, Ian L., LE, Huiling, SEVERN, Katie E. Smoothing splines on Riemannian manifolds, with applications to 3D shape space. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 2021, vol. 83, no 1, p. 108-132. <a class="reference external" href="https://doi.org/10.1111/rssb.12402">https://doi.org/10.1111/rssb.12402</a></p>
</dd>
<dt class="label" id="gmtp2021"><span class="brackets">GMTP2021</span></dt>
<dd><p>GUIGUI, Nicolas, MAIGNANT, Elodie, TROUVE, Alain, PENNEC, Xavier. Parallel Transport on Kendall Shape Spaces. 5th conference on Geometric Science of Information, Paris 2021. Lecture Notes in Computer Science. Springer, 2021. <a class="reference external" href="https://hal.inria.fr/hal-03160677">https://hal.inria.fr/hal-03160677</a></p>
</dd>
</dl>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usecase_hand_poses_analysis_in_kendall_shape_space.html" class="btn btn-neutral float-left" title="Tutorial: Classifying hands poses with Kendall shape spaces" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Geomstats, Inc..
      <span class="lastupdated">Last updated on Jan 13, 2022, 4:07:33 PM.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>