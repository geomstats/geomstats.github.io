
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Hackathon at Institut Henri Poincaré, 17th-21st Oct 2022 &#8212; Geomstats latest documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=c6e86fd7"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'hackathons/ihp_10_2022';</script>
    <link rel="canonical" href="geomstats.github.io/hackathons/ihp_10_2022.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Hackathons" href="../hackathons.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Mar 8, 2024, 9:26:40 AM"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Geomstats latest documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation/index.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../tutorials/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API Reference
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../roadmap.html">
                        Roadmap
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../governance.html">
                        Governance
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../gsod.html">
                        Google Season of Docs
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link dropdown-item nav-internal" href="../hackathons.html">
                        Hackathons
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../explanation/index.html">
                        Explanation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../tutorials/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../contributing/index.html">
                        Contributing Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api/index.html">
                        API Reference
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../roadmap.html">
                        Roadmap
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../governance.html">
                        Governance
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../gsod.html">
                        Google Season of Docs
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link dropdown-item nav-internal" href="../hackathons.html">
                        Hackathons
                      </a>
                    </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hackathon at Institut Henri Poincaré, 17th-21st Oct 2022</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../hackathons.html" class="nav-link">Hackathons</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Hackathon...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="hackathon-at-institut-henri-poincare-17th-21st-oct-2022">
<h1>Hackathon at Institut Henri Poincaré, 17th-21st Oct 2022<a class="headerlink" href="#hackathon-at-institut-henri-poincare-17th-21st-oct-2022" title="Link to this heading">#</a></h1>
<p>This hackathon happened at IHP within the thematic trimester on <a class="reference external" href="https://indico.math.cnrs.fr/category/498/">Geometry and Statistics in Data Sciences</a>.</p>
<p>Several participants made their first contributions to <code class="docutils literal notranslate"><span class="pre">geomstats</span></code>. In no particular order: Francesco Ballerin (University of Bergen), Juliane Braunsmann (WWU Munster), Antoine Collas (Paris-Saclay University), John Harvey (Cardiff University), Emmanuel Hartman (Florida State University), and Joan Glaunès (Université Paris Descartes).</p>
<p>Besides the usual informal schedule, we had a very fruitful presentation by Jean Feydy (INRIA), entitled “Fast geometric libraries for vision and data sciences”.</p>
<p>It was a prolific week in terms of (great) discussions about math and programming. Several actions to improve our code base originated from them. The next section describes them and the rationale behind the changes that will be implemented.</p>
<section id="future-changes">
<h2>Future changes<a class="headerlink" href="#future-changes" title="Link to this heading">#</a></h2>
<section id="equip-with-metric">
<h3>Equip with metric<a class="headerlink" href="#equip-with-metric" title="Link to this heading">#</a></h3>
<p>The following way of instantiating a space and equipping it with a metric will become standard:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geomstats.geometry.hypersphere</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Hypersphere</span><span class="p">,</span>
    <span class="n">HypersphereMetric</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">space</span> <span class="o">=</span> <span class="n">Hypersphere</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">equip</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">space</span><span class="o">.</span><span class="n">equip_with_metric</span><span class="p">(</span><span class="n">HypersphereMetric</span><span class="p">)</span>
</pre></div>
</div>
<p>This means metrics are no more objects that should be instantiated by themselves, i.e. metrics are associated with spaces. To use methods available within the metric, it is now preferred to do <code class="docutils literal notranslate"><span class="pre">space.metric.&lt;method&gt;</span></code> instead of simply instantiating a metric and do <code class="docutils literal notranslate"><span class="pre">metric.&lt;method&gt;</span></code>.</p>
<p>Mathematically, this means that <code class="docutils literal notranslate"><span class="pre">space.equip_with_metric</span></code> transforms our smooth manifold <span class="math notranslate nohighlight">\(M\)</span> into the tuple <span class="math notranslate nohighlight">\((M, g)\)</span>. The boolean <code class="docutils literal notranslate"><span class="pre">equip</span></code> allows to have the possibility to instantiate a non-equipped manifold. In order to keep the current behavior and for practical reasons (e.g. it can be cumbersome to equip a space that only has one “valid” metric; it is nice to have embedding spaces already equipped), <code class="docutils literal notranslate"><span class="pre">equip=True</span></code> by default, which means the following code is equivalent to the above:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">space</span> <span class="o">=</span> <span class="n">Hypersphere</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>We will now ask contributors to add <code class="docutils literal notranslate"><span class="pre">_default_metric</span></code> method to their classes, which returns the default metric for a given class (not instantiated). This will be used to equip the manifold when <code class="docutils literal notranslate"><span class="pre">equip=True</span></code>. Metrics that require additional parameters (e.g. <code class="docutils literal notranslate"><span class="pre">ElasticMetric</span></code>) should also return a dictionary with default values for them.</p>
<p>When equipping a space with a metric that requires additional parameters, a keyword-argument syntax should be user:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">space</span><span class="o">.</span><span class="n">equip_with_metric</span><span class="p">(</span><span class="n">ElasticMetric</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
<p>With this (seemingly small) change, we can now have (benign) circularity in our design, i.e. the space “knows” about the metric, and the metric “knows” about the space. This is achieved by requiring the first input argument of a metric to be the space:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">HypersphereMetric</span><span class="p">(</span><span class="n">RiemannianMetric</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
        <span class="c1"># init operations</span>
</pre></div>
</div>
<p>will become:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">HypersphereMetric</span><span class="p">(</span><span class="n">RiemannianMetric</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">space</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_space</span> <span class="o">=</span> <span class="n">space</span>
        <span class="c1"># other init operations</span>
</pre></div>
</div>
<p>Notice that now <code class="docutils literal notranslate"><span class="pre">HypersphereMetric</span></code> has access to <code class="docutils literal notranslate"><span class="pre">dim</span></code> via <code class="docutils literal notranslate"><span class="pre">self._space</span></code>, which means there’s only one <code class="docutils literal notranslate"><span class="pre">dim</span></code> (the one from <code class="docutils literal notranslate"><span class="pre">space</span></code>) and no inconsistencies are allowed by design (e.g. equip a space with a metric that has an inappropriate <code class="docutils literal notranslate"><span class="pre">dim</span></code>). This also removes the toll of checking input arguments for consistency.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">space</span></code> should be stored privately in the metric to avoid the recursion <code class="docutils literal notranslate"><span class="pre">space.metric.space.metric.&lt;...&gt;</span></code>. The recursion is still allowed, but a user that accesses a private method from “outside” knows he/she’s making a mistake.</p>
<p>Additionally, a difficult design problem is solved: how to access methods of the space within the metric? This is particularly relevant for quotient spaces (e.g. <code class="docutils literal notranslate"><span class="pre">QuotientMetric</span></code> requires <code class="docutils literal notranslate"><span class="pre">FiberBundle</span></code>, and <code class="docutils literal notranslate"><span class="pre">GraphSpaceMetric</span></code> needs <code class="docutils literal notranslate"><span class="pre">GraphSpace</span></code>) and was creating a design divergence where some metrics required the space, whereas others no: now all the metrics require the space.</p>
<p>Moreover, we force each space to contain only one metric, since an equipped instance of a space represents <span class="math notranslate nohighlight">\((M, g)\)</span>.</p>
<p>Similar actions will be done regarding equipping a space with a group action.</p>
</section>
<section id="intrinsic-vs-extrinsic-coordinates-manifold">
<h3>Intrinsic vs extrinsic coordinates (manifold)<a class="headerlink" href="#intrinsic-vs-extrinsic-coordinates-manifold" title="Link to this heading">#</a></h3>
<p>At a lower level, a manifold is expected to implement points via <code class="docutils literal notranslate"><span class="pre">extrinsic</span></code> OR <code class="docutils literal notranslate"><span class="pre">intrinsic</span></code> coordinates, never both.</p>
<p>This means that code as the following will not be allowed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">space</span> <span class="o">=</span> <span class="n">MySpace</span><span class="p">(</span><span class="n">default_coords_type</span><span class="o">=</span><span class="s2">&quot;extrinsic&quot;</span><span class="p">)</span>

<span class="n">space</span><span class="o">.</span><span class="n">default_coords_type</span> <span class="o">=</span> <span class="s2">&quot;intrinsic&quot;</span>
</pre></div>
</div>
<p>That is, instances of a manifold are expected to be static, i.e. if you want a different point representation of your space, you should instantiate a new object.</p>
<p>The main rationale behind this decision is maintainability. For example, each method of the manifold knows exactly which array shape to expect (and what each array represents). This will remove a lot of ifs from the code base (remember that ifs relate to complexity). It will also allow to have a more meaningful code hierarchy, as different representations of the same space may rely on different definitions of manifold.</p>
<p>Besides, we expect usability to increase, as a user also knows exactly which kind of points each of the objects is able to manipulate.</p>
<p>For the end user, no significant change will happen at instantiation level, as we will rely on interfaces (similarly to what is currently done with <code class="docutils literal notranslate"><span class="pre">Hyperbolic</span></code>). An interface in this case is simply a class with <code class="docutils literal notranslate"><span class="pre">__new__</span></code> which returns an instance of another class. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Hypersphere</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">intrinsic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">intrinsic</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">IntrinsicHypersphere</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">equip</span><span class="o">=</span><span class="n">equip</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ExtrinsicHypersphere</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">equip</span><span class="o">=</span><span class="n">equip</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="intrinsic-vs-extrinsic-coordinates-connection">
<h3>Intrinsic vs extrinsic coordinates (connection)<a class="headerlink" href="#intrinsic-vs-extrinsic-coordinates-connection" title="Link to this heading">#</a></h3>
<p>Similarly to the manifold, the connection inheritance structure will also be affected by the clearer distinction between <code class="docutils literal notranslate"><span class="pre">extrinsic</span></code> and <code class="docutils literal notranslate"><span class="pre">intrinsic</span></code> (in fact, changes in the manifold structure tend to be reflected in the connection structure and vice-versa).</p>
<p>Here, this distinction will reduce namespace pollution (“ill-defined” methods will not be available to many children), make testing easier (e.g. currently there are many skips in tests due to “inappropriate” method inheritance), and reduce information overload to a class user (e.g. <code class="docutils literal notranslate"><span class="pre">dir(&lt;MyMetric&gt;)</span></code> will only show methods that are properly defined).</p>
<p>To make it more concrete, we will keep in <code class="docutils literal notranslate"><span class="pre">Connection</span></code> only methods that return coordinate invariant objects (e.g. scalars), and move coordinate dependent methods to <code class="docutils literal notranslate"><span class="pre">IntrinsicConnection</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">christoffels</span></code>, <code class="docutils literal notranslate"><span class="pre">riemannian_tensor</span></code>, etc).</p>
</section>
<section id="no-dynamic-behavior">
<h3>No dynamic behavior<a class="headerlink" href="#no-dynamic-behavior" title="Link to this heading">#</a></h3>
<p>As described above, spaces are not intended to be changed from “outside” after being instantiated. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">space</span> <span class="o">=</span> <span class="n">SPDMatrices</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">space</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>is now seen as inadequate code.</p>
<p>We will not enforce this kind of code to fail for most cases, but we will make the assumption it is mistaken code (i.e. a user can still do it, but at his/her own responsibility). If you want to change attributes of your space, then create a new instance of it.</p>
<p>This seemingly small change frees up the developer’s mind, as he/she does not have to think about all the ways a user may change an object dynamically.</p>
<p>There’s an exception to this: numerical-related parameters are allowed to be changed. For example, some classes will have what we call a <code class="docutils literal notranslate"><span class="pre">ExpSolver</span></code> (more on this in the next section). In this case it is convenient to do something like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">space</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">exp_solver</span><span class="o">.</span><span class="n">n_steps</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
<p>(The above code changes the number of steps performed during integration of the geodesic equation during the solution of an initial value problem.)</p>
<p>The important distinction is that this code does not change anything related to mathematical properties (the equipped space still represents the same tuple <span class="math notranslate nohighlight">\((M, g)\)</span>): it simply changes the parameters of numerical algorithms used to find solutions to manifold/metric operations that do not have closed-form solutions.</p>
</section>
<section id="numerics">
<h3>numerics<a class="headerlink" href="#numerics" title="Link to this heading">#</a></h3>
<p>Since more and more manifolds/metrics in <code class="docutils literal notranslate"><span class="pre">geomstats</span></code> require the use of numerical methods, we will create the subpackage <code class="docutils literal notranslate"><span class="pre">geomstats.numerics</span></code>. It will contain (names may change in the future):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">optimizers</span></code>: mostly wrappers around external optimization libraries (e.g. <code class="docutils literal notranslate"><span class="pre">scipy</span></code>). These wrappers will also handle type conversion due to backend/external libraries inconsistencies (e.g. <code class="docutils literal notranslate"><span class="pre">scipy</span></code> works with <code class="docutils literal notranslate"><span class="pre">torch</span></code> tensors, but returns <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays. The end user should receive <code class="docutils literal notranslate"><span class="pre">torch</span></code> tensors), freeing-up new contributors of thinking about it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ode_solvers</span></code>: will contain machinery to solve initial value problems (IVP) and boundary value problems (BVP). It will contain both “in-house” solvers (e.g. integrators) and wrappers to external libraries (e.g. <code class="docutils literal notranslate"><span class="pre">scipy</span></code>). Keeping in-house solvers gives us more flexibility in terms of automatic differentiation (some external libraries will not work with AD) and vectorization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parallel_transport</span></code>: ladder parallel transport methods will be moved here, and removed from <code class="docutils literal notranslate"><span class="pre">Connection</span></code>. <code class="docutils literal notranslate"><span class="pre">Connection</span></code> will instantiate a <code class="docutils literal notranslate"><span class="pre">ParallelTransporter</span></code> if no closed-form solution exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geodesic_solvers</span></code>: will contain <code class="docutils literal notranslate"><span class="pre">LogSolver</span></code> and <code class="docutils literal notranslate"><span class="pre">ExpSolver</span></code> (a hierarchy of solvers), which will be mostly composed of optimizers or ode solvers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numerical_integrators</span></code>: will contain numerical integration machinery.</p></li>
</ul>
<p>The goal of creating smaller objects to numerically solve some problems comes from the belief that there’s no best algorithm to numerically solve a problem. Some algorithms are faster, other are more accurate, but in the end, the definition of best is context-dependent.</p>
<p>Therefore, manifolds/metrics should not hard code any numerical algorithm, but receive an external object to solve the numerical problem (while keeping “syntax sugar”: e.g. <code class="docutils literal notranslate"><span class="pre">metric.exp</span></code> will still be available, but under the hood it will call <code class="docutils literal notranslate"><span class="pre">metric.exp_solver.exp</span></code>). Sensitive defaults should also be provided for users that do not want to care about this. “Sensitive defaults” in our context means accurate.</p>
<p>This way, manifolds/metrics will receive numerical “solvers” by composition (e.g. a solver instance will be available within a manifold/metric instance in the same way an <code class="docutils literal notranslate"><span class="pre">embedding_space</span></code> is available), and are responsible for defining a proper interface to interact with them (e.g. as in the <code class="docutils literal notranslate"><span class="pre">metric.exp_solver.exp</span></code> described above). At instantiation time proper default objects will be created, but a user can always feed a solver that is more appropriate for his/her use case. Unnecessary objects will not be instantiated (e.g. if a metric has a closed-form solution for <code class="docutils literal notranslate"><span class="pre">exp</span></code>, <code class="docutils literal notranslate"><span class="pre">metric.exp_solver</span></code> will not exist). The possibility to compare closed-form solutions with numerical ones is still available, but requires the instantiation of an external solver.</p>
<p>This design has several advantages:</p>
<ul class="simple">
<li><p><strong>modularity</strong>: implementations of different numerical algorithms “live alone” and do not interact. Meaning, if we want to implement a new numerical algorithm, we just need to create a new (small) object with proper API.</p></li>
<li><p><strong>manifolds/metrics will become close to modifications</strong> (see <a class="reference external" href="https://en.wikipedia.org/wiki/Open%E2%80%93closed_principle">open-closed principle</a>). For example, currently we have the private methods <code class="docutils literal notranslate"><span class="pre">_pole_ladder_step</span></code> and <code class="docutils literal notranslate"><span class="pre">_schild_ladder_step</span></code> in <code class="docutils literal notranslate"><span class="pre">Connection</span></code>. Assuming we want to add a different ladder step, we will need to perform two operations: i) implement <code class="docutils literal notranslate"><span class="pre">_&lt;new-step-name&gt;_ladder_step</span></code>, ii) change <code class="docutils literal notranslate"><span class="pre">ladder_parallel_transport</span></code> to interface with the new step type. The second step goes against the open-closed principle, as we have to modify a <code class="docutils literal notranslate"><span class="pre">Connection</span></code> method to be able to add a new step type. In the worst-case scenario we will introduce bugs while doing it. In the best-case scenario, we will spend mental energy thinking about how to avoid breaking already working code. With the suggested design, we simply care about creating a new (small) object with proper API.</p></li>
<li><p><strong>handling of numerical parameters will be simplified</strong>. Different algorithms require different numerical parameters. Passing numerical parameters as arguments in methods (e.g. as it is currently done in <code class="docutils literal notranslate"><span class="pre">Connection.exp</span></code>) is very dirty because it implies API differences or the use of <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> (which becomes unreadable pretty fast). With the new approach we know numerical parameters must be changed in the respective objects (e.g. <code class="docutils literal notranslate"><span class="pre">space.metric.exp_solver.n_steps</span> <span class="pre">=</span> <span class="pre">20</span></code>) and we know what are the numerical parameters we can tweak simply by looking at the documentation of the corresponding object.</p></li>
<li><p><strong>learning algorithms only care about passing the “geometrically” required arguments to “geometric” operations</strong>. Following the previous point, the fact that numerical parameters are controlled via state allows to only pass geometrically meaningful arguments to methods (e.g. <code class="docutils literal notranslate"><span class="pre">exp</span></code> will receive <code class="docutils literal notranslate"><span class="pre">tangent_vec</span></code> and <code class="docutils literal notranslate"><span class="pre">base_point</span></code>; <code class="docutils literal notranslate"><span class="pre">log</span></code> receives <code class="docutils literal notranslate"><span class="pre">point</span></code> and <code class="docutils literal notranslate"><span class="pre">base_point</span></code>). This means we can set the numerical parameters before passing an equipped space to a learning algorithm. Currently, we have no way of controlling the parameters of <code class="docutils literal notranslate"><span class="pre">log</span></code>, <code class="docutils literal notranslate"><span class="pre">exp</span></code>, etc, when we use an equipped space within a learning algorithm.</p></li>
<li><p><strong>history will be easier to turn off/on</strong>. For example, in some use cases of parallel transport we are only interested in parallel transporting a tangent vector and we do not want to access the trajectory. In other cases, the trajectory is important. Having a <code class="docutils literal notranslate"><span class="pre">ParallelTransporter</span></code> object allows to handle these use cases easily by having a boolean parameter e.g. <code class="docutils literal notranslate"><span class="pre">save_trajectory=True</span></code> that turns off/on the saving of the trajectory. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, all the additional operations required to save the trajectory will not be done (which may lead to better performance and less memory use). If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the trajectory should be stored within the object (e.g. by creating the attribute <code class="docutils literal notranslate"><span class="pre">self.trajectory_</span></code>; naming follows <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> naming convention), but never be returned, as we want to keep the same API. A similar behavior can be achieved without the creation of an additional object, but then the question of where to save the trajectory arises. “In <code class="docutils literal notranslate"><span class="pre">Connection</span></code>” may be a OK answer, but it will lead fast to namespace pollution. The same applies to optimization problems, solution of ODEs, etc. This is especially interesting for research.</p></li>
<li><p><strong>combine different numerical algorithms</strong>. After having different algorithms implemented as small objects, we can start combining them using composition. For example, we can have a less accurate (but fast) <code class="docutils literal notranslate"><span class="pre">LogSolver</span></code> to create the initialization for a more accurate <code class="docutils literal notranslate"><span class="pre">LogSolver</span></code>. Hard coding them in a <code class="docutils literal notranslate"><span class="pre">Connection</span></code> would have never allowed this kind of combinations.</p></li>
</ul>
<p>For a contributor, setting a (default) numerical algorithm follows a similar strategy as <code class="docutils literal notranslate"><span class="pre">_define_default_metric</span></code> shown above. The only difference is that it should return an instance, instead of the class. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyMetric</span><span class="p">(</span><span class="n">RiemannianMetric</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_define_exp_solver</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="k">return</span> <span class="n">MyNiceExpSolver</span><span class="p">(</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">_define_exp_solver</span></code> does not exist, we will assume a closed-form solution is implemented. A nice error message will be implemented in <code class="docutils literal notranslate"><span class="pre">Connection.exp</span></code> to help contributors know what to change if something goes wrong.</p>
</section>
<section id="gs-matrices">
<h3>gs.matrices<a class="headerlink" href="#gs-matrices" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Matrices</span></code>, <code class="docutils literal notranslate"><span class="pre">SymmetricMatrices</span></code>, and <code class="docutils literal notranslate"><span class="pre">SPDMatrices</span></code> have several linear algebra-related (class) methods that are useful in several parts of the code. Having to import them any time we need to perform these operations increases the likelihood of circular imports and makes everything messier. Besides, these methods are a bit hidden within these classes as <code class="docutils literal notranslate"><span class="pre">geomstats.geometry</span></code> is supposed to handle geometric operations. We will then move them to the backend (under <code class="docutils literal notranslate"><span class="pre">gs.matrices</span></code>), ensure proper testing, and add backend documentation.</p>
<p>One question that arises with this is that some methods are particular to specific kinds of matrices. We will follow <code class="docutils literal notranslate"><span class="pre">numpy</span></code>/<code class="docutils literal notranslate"><span class="pre">scipy</span></code> conventions to handle this (e.g. <code class="docutils literal notranslate"><span class="pre">eig</span></code> vs <code class="docutils literal notranslate"><span class="pre">eigh</span></code>). Moreover, we will have a <code class="docutils literal notranslate"><span class="pre">check</span></code> boolean parameter set to <code class="docutils literal notranslate"><span class="pre">False</span></code> by default, meaning we will not check if a user that is calling <code class="docutils literal notranslate"><span class="pre">eigh</span></code> is really passing a hermitian matrix, as these checks are computationally expensive (the possibility of <code class="docutils literal notranslate"><span class="pre">check=True</span></code> is especially attractive during development/debugging).</p>
</section>
<section id="points-shape">
<h3>Points shape<a class="headerlink" href="#points-shape" title="Link to this heading">#</a></h3>
<p>Methods in <code class="docutils literal notranslate"><span class="pre">geomstats.geometry</span></code> will still be able to receive one point or multiple points, but some behaviors will be slightly modified. In particular, the following behaviors are expected for a method that receives a 1d point and returns a 1d point (after some operations):</p>
<ol class="arabic simple">
<li><p>input: 1d -&gt; output: 1d</p></li>
<li><p>input: 2d (multiple points) -&gt; output: 2d (multiple points)</p></li>
<li><p>input: 2d (one point) -&gt; output: 2d (one point)</p></li>
</ol>
<p>The last behavior is new, as currently if we have one point as input, we will always return a 1d array (for the 1d-1d case). This means <code class="docutils literal notranslate"><span class="pre">gs.squeeze</span></code> will have to be used at a much lower extent.</p>
</section>
<section id="new-structure">
<h3>New structure<a class="headerlink" href="#new-structure" title="Link to this heading">#</a></h3>
<p>The folder structure will be modified to better separate different mathematical structures. More on this soon!</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../hackathons.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Hackathons</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#future-changes">Future changes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equip-with-metric">Equip with metric</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intrinsic-vs-extrinsic-coordinates-manifold">Intrinsic vs extrinsic coordinates (manifold)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intrinsic-vs-extrinsic-coordinates-connection">Intrinsic vs extrinsic coordinates (connection)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-dynamic-behavior">No dynamic behavior</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerics">numerics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gs-matrices">gs.matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#points-shape">Points shape</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#new-structure">New structure</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/hackathons/ihp_10_2022.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022-2023, Geomstats, Inc..
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>